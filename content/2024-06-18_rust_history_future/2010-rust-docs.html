<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- Created on June 13, 2024 by texi2html 5.0
texi2html was written by: 
            Lionel Cons <Lionel.Cons@cern.ch> (original author)
            Karl Berry  <karl@freefriends.org>
            Olaf Bachmann <obachman@mathematik.uni-kl.de>
            and many others.
Maintained by: Many creative people.
Send bugs and suggestions to <texi2html-bug@nongnu.org>
-->
<head>
<title>Rust Documentation</title>

<meta name="description" content="Rust Documentation">
<meta name="keywords" content="Rust Documentation">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="texi2html 5.0">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
pre.display {font-family: serif}
pre.format {font-family: serif}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: serif; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: serif; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nocodebreak {white-space:pre}
span.nolinebreak {white-space:pre}
span.roman {font-family:serif; font-weight:normal}
span.sansserif {font-family:sans-serif; font-weight:normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en" bgcolor="#FFFFFF" text="#000000" link="#0000FF" vlink="#800080" alink="#FF0000">

<h1>Rust</h1>
<h3 align="right">A safe, concurrent, practical language.</h3>
<strong>Graydon Hoare</strong><br>
<strong>Mozilla Foundation</strong><br>


<p>Copyright &copy; 2006-2010 Graydon Hoare
</p>
<p>Copyright &copy; 2009-2010 Mozilla Foundation
</p>
<p>See accompanying LICENSE.txt for terms.
</p><hr>
<a name="Top"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[ &lt; ]</td>
<td valign="middle" align="left">[<a href="#Disclaimer" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Top-1"></a>
<h1 class="top">Top</h1>

<p>Rust Documentation
</p>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Disclaimer">1 Disclaimer</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Notes on a work in progress.
</td></tr>
<tr><td align="left" valign="top"><a href="#Introduction">2 Introduction</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Background, intentions, lineage.
</td></tr>
<tr><td align="left" valign="top"><a href="#Tutorial">3 Tutorial</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                   Gentle introduction to reading Rust code.
</td></tr>
<tr><td align="left" valign="top"><a href="#Reference">4 Reference</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                  Systematic reference of language elements.
</td></tr>
<tr><td align="left" valign="top"><a href="#Index">5 Index</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top"></td></tr>
</table>

<p>Complete table of contents
</p>


<hr size="6">
<a name="Disclaimer"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Disclaimer-1"></a>
<h1 class="chapter">1 Disclaimer</h1>

<p>To the reader,
</p>
<p>Rust is a work in progress. The language continues to evolve as the design
shifts and is fleshed out in working code. Certain parts work, certain parts
do not, certain parts will be removed or changed.
</p>
<p>This manual is a snapshot written in the present tense. Some features
described do not yet exist in working code. Some may be temporary. It
is a <em>draft</em>, and we ask that you not take anything you read here
as either definitive or final. The manual is to help you get a sense
of the language and its organization, not to serve as a complete
specification. At least not yet.
</p>
<p>If you have suggestions to make, please try to focus them on <em>reductions</em>
to the language: possible features that can be combined or omitted. At this
point, every &ldquo;additive&rdquo; feature we&rsquo;re likely to support is already on the
table. The task ahead involves combining, trimming, and implementing.
</p>


<hr>
<a name="Introduction"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Disclaimer" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Disclaimer" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Goals" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tutorial" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Introduction-1"></a>
<h1 class="chapter">2 Introduction</h1>

<blockquote>
<p>  We have to fight chaos, and the most effective way of doing that is
  to prevent its emergence.
</p><p align="right">                                   - Edsger Dijkstra
</p></blockquote>
<br>
<br>

<p>Rust is a curly-brace, block-structured statement language. It visually
resembles the C language family, but differs significantly in syntactic and
semantic details. Its design is oriented toward concerns of &ldquo;programming in
the large&rdquo;, that is, of creating and maintaining <em>boundaries</em> &ndash; both
abstract and operational &ndash; that preserve large-system <em>integrity</em>,
<em>availability</em> and <em>concurrency</em>.
</p>
<p>It supports a mixture of imperative procedural, concurrent actor, object
oriented and pure functional styles. Rust also supports generic programming
and metaprogramming, in both static and dynamic styles.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Goals">2.1 Goals</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                      Intentions, motivations.
</td></tr>
<tr><td align="left" valign="top"><a href="#Sales-Pitch">2.2 Sales Pitch</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                A summary for the impatient.
</td></tr>
<tr><td align="left" valign="top"><a href="#Influences">2.3 Influences</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Relationship to past languages.
</td></tr>
</table>


<hr>
<a name="Goals"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Sales-Pitch" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tutorial" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Goals-1"></a>
<h2 class="section">2.1 Goals</h2>

<p>The language design pursues the following goals:
</p>
<br>
<ul>
<li> Compile-time error detection and prevention.
</li><li> Run-time fault tolerance and containment.
</li><li> System building, analysis and maintenance affordances.
</li><li> Clarity and precision of expression.
</li><li> Implementation simplicity.
</li><li> Run-time efficiency.
</li><li> High concurrency.
</li></ul>
<br>

<p>Note that most of these goals are <em>engineering</em> goals, not showcases for
sophisticated language technology. Most of the technology in Rust is
<em>old</em> and has been seen decades earlier in other languages.
</p>
<p>All new languages are developed in a technological context. Rust&rsquo;s goals arise
from the context of writing large programs that interact with the internet &ndash;
both servers and clients &ndash; and are thus much more concerned with
<em>safety</em> and <em>concurrency</em> than older generations of program. Our
experience is that these two forces do not conflict; rather they drive system
design decisions toward extensive use of <em>partitioning</em> and
<em>statelessness</em>. Rust aims to make these a more natural part of writing
programs, within the niche of lower-level, practical, resource-conscious
languages.
</p>


<hr>
<a name="Sales-Pitch"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Goals" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Influences" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tutorial" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Sales-Pitch-1"></a>
<h2 class="section">2.2 Sales Pitch</h2>

<p>The following comprises a brief &ldquo;sales pitch&rdquo; overview of the salient
features of Rust, relative to other languages.
</p>
<ul>
<li>
<br>
</li><li> No <code>null</code> pointers

<p>The initialization state of every slot is statically computed as part of the
typestate system (see below), and requires that all slots are initialized
before use. There is no <code>null</code> value; uninitialized slots are
uninitialized, and can only be written to, not read.
</p>
<p>The common use for <code>null</code> in other languages &ndash; as a sentinel value &ndash; is
subsumed into the more general facility of disjoint union types. A program
must explicitly model its use of such types.
</p>
<br>
</li><li> Lightweight tasks with no shared mutable state

<p>Like many <em>actor</em> languages, Rust provides an isolation (and concurrency)
model based on lightweight tasks scheduled by the language runtime. These
tasks are very inexpensive and statically unable to mutate one another&rsquo;s local
memory. Breaking the rule of task isolation is only possible by calling
external (C/C++) code.
</p>
<p>Inter-task communication is typed, asynchronous and simplex, based on passing
messages over channels to ports. Transmission can be rate-limited or
rate-unlimited. Selection between multiple senders is pseudo-randomized on the
receiver side.
</p>
<br>
</li><li> Predictable native code, simple runtime

<p>The meaning and cost of every operation within a Rust program is intended to
be easy to model for the reader. The code should not &ldquo;surprise&rdquo; the
programmer once it has been compiled.
</p>
<p>Rust compiles to native code. Rust compilation units are large and the
compilation model is designed around multi-file, whole-library or
whole-program optimization. The compiled units are standard loadable objects
(ELF, PE, Mach-O) containing standard metadata (DWARF) and are compatible with
existing, standard low-level tools (disassemblers, debuggers, profilers,
dynamic loaders).
</p>
<p>The Rust runtime library is a small collection of support code for scheduling,
memory management, inter-task communication, reflection and runtime
linkage. This library is written in standard C++ and is quite
straightforward. It presents a simple interface to embeddings. No
research-level virtual machine, JIT or garbage collection technology is
required. It should be relatively easy to adapt a Rust front-end on to many
existing native toolchains.
</p>
<br>
</li><li> Integrated system-construction facility

<p>The units of compilation of Rust are multi-file amalgamations called
<em>crates</em>. A crate is described by a separate, declarative type of source
file that guides the compilation of the crate, its packaging, its versioning,
and its external dependencies. Crates are also the units of distribution and
loading. Significantly: the dependency graph of crates is <em>acyclic</em> and
<em>anonymous</em>: there is no global namespace for crates, and module-level
recursion cannot cross crate barriers.
</p>
<p>Unlike many languages, individual modules do <em>not</em> carry all the
mechanisms or restrictions of crates. Modules and crates serve different
roles.
</p>
<br>
</li><li> Stack-based iterators

<p>Rust provides a type of function-like multiple-invocation iterator that is
very efficient: the iterator state lives only on the stack and is tightly
coupled to the loop that invoked it.
</p>
<br>
</li><li> Direct interface to C code

<p>Rust can load and call many C library functions simply by declaring
them. Calling a C function statically marks a function as &ldquo;unsafe&rdquo;, unless
the task calling the unsafe function is further isolated within an external
&ldquo;heavyweight&rdquo; operating-system subprocess. Every &ldquo;unsafe&rdquo; function or
module in a Rust compilation unit must be explicitly authorized in the crate
file.
</p>
<br>
</li><li> Structural algebraic data types

<p>The Rust type system is structural rather than nominal, and contains the
standard assortment of useful &ldquo;algebraic&rdquo; type constructors from functional
languages, such as function types, tuples, record types, vectors, and tagged
disjoint unions. Structural types may be <em>pattern-matched</em> in an
<code>alt</code> statement.
</p>
<br>
</li><li> Generic code

<p>Rust supports a simple form of parametric polymorphism: functions, iterators,
types and objects can be parametrized by other types.
</p>
<br>
</li><li> Argument binding

<p>Rust provides a mechanism of partially binding arguments to functions,
producing new functions that accept the remaining un-bound arguments. This
mechanism combines some of the features of lexical closures with some of the
features of currying, in a smaller and simpler package.
</p>
<br>
</li><li> Local type inference

<p>To save some quantity of programmer key-pressing, Rust supports local type
inference: signatures of functions, objects and iterators always require type
annotation, but within the body of a function or iterator many slots can be
declared <code>auto</code> and Rust will infer the slot&rsquo;s type from its uses.
</p>
<br>
</li><li> Structural object system

<p>Rust has a lightweight object system based on structural object types: there
is no &ldquo;class hierarchy&rdquo; nor any concept of inheritance. Method overriding
and object restriction are performed explicitly on object values, which are
little more than order-insensitive records of methods sharing a common private
value. Objects can be mutable or immutable, and immutable objects can have
destructors.
</p>
<br>
</li><li> Dynamic type

<p>Rust includes support for slots of a top type, <code>any</code>, that can hold any
type of value whatsoever. An <code>any</code> slot is a pair of a type code and an
exterior value of that type. Injection into an <code>any</code> and projection by
type-case-selection is integrated into the language.
</p>
<br>
</li><li> Dynamic metaprogramming (reflection)

<p>Rust supports run-time reflection on the structure of a crate, using a
combination of custom descriptor structures and the DWARF metadata tables used
to support crate linkage and other runtime services.
</p>
<br>
</li><li> Static metaprogramming (syntactic extension)

<p>Rust supports a system for syntactic extensions that can be loaded into the
compiler, to implement user-defined notations, macros, program-generators and
the like. These notations are <em>marked</em> using a special form of
bracketing, such that a reader unfamiliar with the extension can still parse
the surrounding text by skipping over the bracketed &ldquo;extension text&rdquo;.
</p>
<br>
</li><li> Idempotent failure

<p>If a task fails due to a signal, or if it executes the special <code>fail</code>
statement, it enters the <em>failing</em> state. A failing task unwinds its
control stack, frees all of its owned resources (executing destructors) and
enters the <em>dead</em> state. Failure is idempotent and non-recoverable.
</p>
<br>
</li><li> Signal handling

<p>Rust has a system for propagating task-failures and other spontaneous
events between tasks. Some signals can be trapped and redirected to
channels; other signals are fatal and result in task-failure. Tasks
can designate other tasks to handle signals for them. This permits
organizing tasks into mutually-supervising or mutually-failing groups.
</p>
<br>
</li><li> Deterministic destruction

<p>Immutable objects can have destructor functions, which are executed
deterministically in top-down ownership order, as control frames are exited
and/or objects are otherwise freed from data structures holding them. The same
destructors are run in the same order whether the object is deleted by
unwinding during failure or normal execution.
</p>
<p>Similarly, the rules for freeing immutable memory are deterministic and
predictable: on scope-exit or structure-release, interior slots are released
immediately, exterior slots have their reference count decreased and are
released if the count drops to zero. Alias slots are not affected by scope
exit.
</p>
<p>Mutable memory is local to a task, and is subject to per-task garbage
collection. As a result, unreferenced mutable memory is not necessarily freed
immediately; if it is acyclic it is freed when the last reference to it drops,
but if it is part of a reference cycle it will be freed when the GC collects
it (or when the owning task terminates, at the latest).
</p>
<p>Mutable memory can point to immutable memory but not vice-versa. Doing so
merely delays (to an undefined future time) the moment when the deterministic,
top-down destruction sequence for the referenced immutable memory
<em>starts</em>. In other words, the immutable &ldquo;leaves&rdquo; of a mutable structure
are released in a locally-predictable order, even if the &ldquo;interior&rdquo; of the
mutable structure is released in an unpredictable order.
</p>
<br>
</li><li> Typestate system

<p>Every storage slot in Rust participates in not only a conventional structural
static type system, describing the interpretation of memory in the slot, but
also a <em>typestate</em> system. The static typestates of a program describe
the set of <em>pure, dynamic predicates</em> that provably hold over some set of
slots, at each point in the program&rsquo;s control flow graph. The static
calculation of the typestates of a program is a dataflow problem, and handles
user-defined predicates in a similar fashion to the way the type system
permits user-defined types.
</p>
<p>A short way of thinking of this is: types statically model the kinds of values
held in slots, typestates statically model <em>assertions that hold</em> before
and after statements.
</p>
<br>
</li><li> Static control over memory allocation, packing and aliasing.

<p>Every variable or field in Rust is a combination of a type, a mutability flag
and a <em>mode</em>; this combination is called a <em>slot</em>. There are 3 kinds
of <em>slot mode</em>, denoting 3 ways of referring to a value:
</p>
<ul>
<li> &ldquo;interior&rdquo; (slot contains value)
</li><li> &ldquo;exterior&rdquo;, (slot points to to managed heap allocation)
</li><li> &ldquo;alias&rdquo;, (slot points directly to provably-live address)
</li></ul>

<p>Interior slots declared as variables in a function are allocated very quickly
on the stack, as part of a local activation frame, as in C or C++. Alias slots
permit efficient by-reference parameter passing without adjusting heap
reference counts or interacting with garbage collection, as alias lifetimes
are statically guaranteed to outlive callee lifetimes.
</p>
<p>Copying data between slots of different modes may cause either a simple
address assignment or reference-count adjustment, or may cause a value to be
&ldquo;transplanted&rdquo;: copied by value from the interior of one memory structure to
another, or between stack and heap. Transplanting, when necessary, is
predictable and automatic, as part of the definition of the copy operator
(<code>=</code>).
</p>
<p>In addition, slots have a static initialization state that is calculated by
the typestate system. This permits late initialization of variables in
functions with complex control-flow, while still guaranteeing that every use
of a slot occurs after it has been initialized.
</p>
<br>
</li><li> Static control over mutability.

<p>Slots in Rust are classified as either immutable or mutable. By default,
all slots are immutable.
</p>
<p>If a slot within a type is declared as <code>mutable</code>, the type is a
<code>state</code> type and must be declared as such.
</p>
<p>This classification of data types in Rust interacts with the memory allocation
and transmission rules. In particular:
</p>
<ul>
<li> Only immutable (non-state) values can be sent over channels.
</li><li> Only immutable (non-state) objects can have destructor functions.
</li></ul>

<p>State values are subject to local (per-task) garbage-collection. Garbage
collection costs are therefore also task-local and do not interrupt or suspend
other tasks.
</p>
<p>Immutable values are reference-counted and have a deterministic destruction
order: top-down, immediately upon release of the last live reference.
</p>
<p>State values can refer to immutable values, but not vice-versa. Rust therefore
encourages the programmer to write in a style that consists primarily of
immutable types, but also permits limited, local (per-task) mutability.
</p>
</li></ul>



<hr>
<a name="Influences"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Sales-Pitch" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Introduction" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Tutorial" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tutorial" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Influences-1"></a>
<h2 class="section">2.3 Influences</h2>
<br>
<br>

<blockquote>
<p>  The essential problem that must be solved in making a fault-tolerant
  software system is therefore that of fault-isolation. Different programmers
  will write different modules, some modules will be correct, others will have
  errors. We do not want the errors in one module to adversely affect the
  behaviour of a module which does not have any errors.
</p>
<p align="right">                                   - Joe Armstrong
</p></blockquote>
<br>
<br>

<blockquote>
<p>  In our approach, all data is private to some process, and processes can
  only communicate through communications channels. <em>Security</em>, as used
  in this paper, is the property which guarantees that processes in a system
  cannot affect each other except by explicit communication.
</p>
<p>  When security is absent, nothing which can be proven about a single module
  in isolation can be guaranteed to hold when that module is embedded in a
  system [...]
</p><p align="right">                                   - Robert Strom and Shaula Yemini
</p></blockquote>
<br>
<br>

<blockquote>
<p>  Concurrent and applicative programming complement each other. The
  ability to send messages on channels provides I/O without side effects,
  while the avoidance of shared data helps keep concurrent processes from
  colliding.
</p><p align="right">                                   - Rob Pike
</p></blockquote>
<br>
<br>


<p>Rust is not a particularly original language. It may however appear unusual by
contemporary standards, as its design elements are drawn from a number of
&ldquo;historical&rdquo; languages that have, with a few exceptions, fallen out of
favour. Five prominent lineages contribute the most:
</p>
<ul>
<li><br>
</li><li>
The NIL (1981) and Hermes (1990) family. These languages were developed by
Robert Strom, Shaula Yemini, David Bacon and others in their group at IBM
Watson Research Center (Yorktown Heights, NY, USA).

<br>
</li><li>
The Erlang (1987) language, developed by Joe Armstrong, Robert Virding, Claes
Wikstr&ouml;m, Mike Williams and others in their group at the Ericsson Computer
Science Laboratory (&Auml;lvsj&ouml;, Stockholm, Sweden) .

<br>
</li><li>
The Sather (1990) language, developed by Stephen Omohundro, Chu-Cheow Lim,
Heinz Schmidt and others in their group at The International Computer Science
Institute of the University of California, Berkeley (Berkeley, CA, USA).

<br>
</li><li>
The Newsqueak (1988), Alef (1995), and Limbo (1996) family. These languages
were developed by Rob Pike, Phil Winterbottom, Sean Dorward and others in
their group at Bell labs Computing Sciences Reserch Center (Murray Hill, NJ,
USA).

<br>
</li><li>
The Napier (1985) and Napier88 (1988) family. These languages were developed
by Malcolm Atkinson, Ron Morrison and others in their group at the University
of St. Andrews (St. Andrews, Fife, UK).
</li></ul>

<br>
<p>Additional specific influences can be seen from the following languages:
</p><ul>
<li> The structural algebraic types and compilation manager of SML.
</li><li> The syntax-extension systems of Camlp4 and the Common Lisp readtable.
</li><li> The deterministic destructor system of C++.
</li></ul>


<hr>
<a name="Tutorial"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Introduction" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Influences" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Tutorial-1"></a>
<h1 class="chapter">3 Tutorial</h1>

<p><em>TODO</em>.
</p>

<hr>
<a name="Reference"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Tutorial" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Tutorial" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Reference-1"></a>
<h1 class="chapter">4 Reference</h1>

<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eLex">4.1 Ref.Lex</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     Lexical structure.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002ePath">4.2 Ref.Path</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    References to slots and items.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eGram">4.3 Ref.Gram</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Grammar.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eComp">4.4 Ref.Comp</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Compilation and component model.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eMem">4.5 Ref.Mem</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     Semantic model of memory.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eTask">4.6 Ref.Task</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Semantic model of tasks.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eItem">4.7 Ref.Item</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    The components of a module.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType">4.8 Ref.Type</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    The types of values held in memory.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eExpr">4.9 Ref.Expr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Parsed and primitive expressions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt">4.10 Ref.Stmt</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                    Executable statements.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eRun">4.11 Ref.Run</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                     Organization of runtime services.
</td></tr>
</table>


<hr>
<a name="Ref_002eLex"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eIgnore" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex-1"></a>
<h2 class="section">4.1 Ref.Lex</h2>

<p>The lexical structure of a Rust source file or crate file is defined in terms
of Unicode character codes and character properties.
</p>
<p>Groups of Unicode character codes and characters are organized into
<em>tokens</em>. Tokens are defined as the longest contiguous sequence of
characters within the same token type (identifier, keyword, literal, symbol),
or interrupted by ignored characters.
</p>
<p>Most tokens in Rust follow rules similar to the C family.
</p>
<p>Most tokens (including identifiers, whitespace, keywords, operators and
structural symbols) are drawn from the ASCII-compatible range of
Unicode. String and character literals, however, may include the full range of
Unicode characters.
</p>
<p><em>TODO: formalize this section much more</em>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eIgnore">4.1.1 Ref.Lex.Ignore</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Ignored characters.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eIdent">4.1.2 Ref.Lex.Ident</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Identifier tokens.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eKey">4.1.3 Ref.Lex.Key</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Keyword tokens.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eNum">4.1.4 Ref.Lex.Num</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Numeric tokens.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eText">4.1.5 Ref.Lex.Text</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         String and character tokens.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eSyntax">4.1.6 Ref.Lex.Syntax</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">       Syntactic extension tokens.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eLex_002eSym">4.1.7 Ref.Lex.Sym</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Special symbol tokens.
</td></tr>
</table>


<hr>
<a name="Ref_002eLex_002eIgnore"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eIdent" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eIgnore-1"></a>
<h3 class="subsection">4.1.1 Ref.Lex.Ignore</h3>

<p>The classes of <em>whitespace</em> and <em>comment</em> is ignored, and are not
considered as tokens.
</p>
<p><em>Whitespace</em> is any of the following Unicode characters: U+0020 (space),
U+0009 (tab, <code>'\t'</code>), U+000A (LF, <code>'\n'</code>), U+000D (CR, <code>'\r'</code>).
</p>
<p><em>Comments</em> are any sequence of Unicode characters beginning with U+002F
U+002F (<code>//</code>) and extending to the next U+000a character,
<em>excluding</em> cases in which such a sequence occurs within a string literal
token or a syntactic extension token.
</p>


<hr>
<a name="Ref_002eLex_002eIdent"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eIgnore" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eKey" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eIdent-1"></a>
<h3 class="subsection">4.1.2 Ref.Lex.Ident</h3>

<p>Identifiers follow the pattern of C identifiers: they begin with a
<em>letter</em> or underscore character <code>_</code> (Unicode character U+005f), and
continue with any combination of <em>letters</em>, <em>digits</em> and
underscores, and must not be equal to any keyword. See section <a href="#Ref_002eLex_002eKey">Ref.Lex.Key</a>.
</p>
<p>A <em>letter</em> is a Unicode character in the ranges U+0061-U+007A and
U+0041-U+005A (<code>a-z</code> and <code>A-Z</code>).
</p>
<p>A <em>digit</em> is a Unicode character in the range U+0030-U0039 (<code>0-9</code>).
</p>

<hr>
<a name="Ref_002eLex_002eKey"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eIdent" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eNum" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eKey-1"></a>
<h3 class="subsection">4.1.3 Ref.Lex.Key</h3>

<p>The keywords are:
</p>
<br>
<br>

<table>
<tr><td width="15%"><code>use</code></td><td width="15%"><code>meta</code></td><td width="15%"><code>syntax</code></td><td width="15%"><code>mutable</code></td><td width="15%"><code>native</code></td></tr>
<tr><td width="15%"><code>mod</code></td><td width="15%"><code>import</code></td><td width="15%"><code>export</code></td><td width="15%"><code>let</code></td><td width="15%"><code>auto</code></td></tr>
<tr><td width="15%"><code>io</code></td><td width="15%"><code>state</code></td><td width="15%"><code>unsafe</code></td><td width="15%"><code>auth</code></td><td width="15%"><code>with</code></td></tr>
<tr><td width="15%"><code>bind</code></td><td width="15%"><code>type</code></td><td width="15%"><code>true</code></td><td width="15%"><code>false</code></td></tr>
<tr><td width="15%"><code>any</code></td><td width="15%"><code>int</code></td><td width="15%"><code>uint</code></td><td width="15%"><code>char</code></td><td width="15%"><code>bool</code></td></tr>
<tr><td width="15%"><code>u8</code></td><td width="15%"><code>u16</code></td><td width="15%"><code>u32</code></td><td width="15%"><code>u64</code></td><td width="15%"><code>f32</code></td></tr>
<tr><td width="15%"><code>i8</code></td><td width="15%"><code>i16</code></td><td width="15%"><code>i32</code></td><td width="15%"><code>i64</code></td><td width="15%"><code>f64</code></td></tr>
<tr><td width="15%"><code>rec</code></td><td width="15%"><code>tup</code></td><td width="15%"><code>tag</code></td><td width="15%"><code>vec</code></td><td width="15%"><code>str</code></td></tr>
<tr><td width="15%"><code>fn</code></td><td width="15%"><code>iter</code></td><td width="15%"><code>obj</code></td><td width="15%"><code>as</code></td><td width="15%"><code>drop</code></td></tr>
<tr><td width="15%"><code>task</code></td><td width="15%"><code>port</code></td><td width="15%"><code>chan</code></td><td width="15%"><code>flush</code></td><td width="15%"><code>spawn</code></td></tr>
<tr><td width="15%"><code>if</code></td><td width="15%"><code>else</code></td><td width="15%"><code>alt</code></td><td width="15%"><code>case</code></td><td width="15%"><code>in</code></td></tr>
<tr><td width="15%"><code>do</code></td><td width="15%"><code>while</code></td><td width="15%"><code>break</code></td><td width="15%"><code>cont</code></td><td width="15%"><code>fail</code></td></tr>
<tr><td width="15%"><code>log</code></td><td width="15%"><code>note</code></td><td width="15%"><code>claim</code></td><td width="15%"><code>check</code></td><td width="15%"><code>prove</code></td></tr>
<tr><td width="15%"><code>for</code></td><td width="15%"><code>each</code></td><td width="15%"><code>ret</code></td><td width="15%"><code>put</code></td><td width="15%"><code>be</code></td></tr>
</table>


<hr>
<a name="Ref_002eLex_002eNum"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eKey" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eText" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eNum-1"></a>
<h3 class="subsection">4.1.4 Ref.Lex.Num</h3>

<p><em>TODO: describe numeric literals</em>.
</p>

<hr>
<a name="Ref_002eLex_002eText"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eNum" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eSyntax" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eText-1"></a>
<h3 class="subsection">4.1.5 Ref.Lex.Text</h3>

<p><em>TODO: describe string and character literals</em>.
</p>

<hr>
<a name="Ref_002eLex_002eSyntax"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eText" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eSym" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eSyntax-1"></a>
<h3 class="subsection">4.1.6 Ref.Lex.Syntax</h3>

<p>Syntactic extensions are marked with the <em>pound</em> sigil <code>#</code> (U+0023),
followed by a qualified name of a compile-time imported module item, an
optional parenthesized list of <em>tokens</em>, and an optional brace-enclosed
region of free-form text (with brace-matching and brace-escaping used to
determine the limit of the region). See section <a href="#Ref_002eComp_002eSyntax">Ref.Comp.Syntax</a>.
</p>
<p><em>TODO: formalize those terms more</em>.
</p>

<hr>
<a name="Ref_002eLex_002eSym"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eSyntax" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002ePath" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eLex_002eSym-1"></a>
<h3 class="subsection">4.1.7 Ref.Lex.Sym</h3>

<p>The special symbols are:
</p>
<br>
<br>

<table>
<tr><td width="10%"><code>@</code></td><td width="10%"><code>_</code></td></tr>
<tr><td width="10%"><code>#</code></td><td width="10%"><code>:</code></td><td width="10%"><code>.</code></td><td width="10%"><code>;</code></td><td width="10%"><code>,</code></td></tr>
<tr><td width="10%"><code>[</code></td><td width="10%"><code>]</code></td><td width="10%"><code>{</code></td><td width="10%"><code>}</code></td><td width="10%"><code>(</code></td><td width="10%"><code>)</code></td></tr>
<tr><td width="10%"><code>=</code></td><td width="10%"><code>&lt;-</code></td><td width="10%"><code>&lt;|</code></td><td width="10%"><code>&lt;+</code></td><td width="10%"><code>-&gt;</code></td></tr>
<tr><td width="10%"><code>+</code></td><td width="10%"><code>++</code></td><td width="10%"><code>+=</code></td><td width="10%"><code>-</code></td><td width="10%"><code>--</code></td><td width="10%"><code>-=</code></td></tr>
<tr><td width="10%"><code>*</code></td><td width="10%"><code>/</code></td><td width="10%"><code>%</code></td><td width="10%"><code>*=</code></td><td width="10%"><code>/=</code></td><td width="10%"><code>%=</code></td></tr>
<tr><td width="10%"><code>&amp;</code></td><td width="10%"><code>|</code></td><td width="10%"><code>!</code></td><td width="10%"><code>~</code></td><td width="10%"><code>^</code></td></tr>
<tr><td width="10%"><code>&amp;=</code></td><td width="10%"><code>|=</code></td><td width="10%"><code>^=</code></td><td width="10%"><code>!=</code></td></tr>
<tr><td width="10%"><code>&gt;&gt;</code></td><td width="10%"><code>&gt;&gt;&gt;</code></td><td width="10%"><code>&lt;&lt;</code></td><td width="10%"><code>&lt;&lt;=</code></td><td width="10%"><code>&gt;&gt;=</code></td><td width="10%"><code>&gt;&gt;&gt;=</code></td></tr>
<tr><td width="10%"><code>&lt;</code></td><td width="10%"><code>&lt;=</code></td><td width="10%"><code>==</code></td><td width="10%"><code>&gt;=</code></td><td width="10%"><code>&gt;</code></td></tr>
<tr><td width="10%"><code>&amp;&amp;</code></td><td width="10%"><code>||</code></td></tr>
</table>



<hr>
<a name="Ref_002ePath"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eLex_002eSym" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eGram" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002ePath-1"></a>
<h2 class="section">4.2 Ref.Path</h2>

<p>A <em>path</em> is a ubiquitous syntactic form in Rust that deserves special
attention. A path denotes a slot or an
item. See section <a href="#Ref_002eMem_002eSlot">Ref.Mem.Slot</a>. See section <a href="#Ref_002eItem">Ref.Item</a>. Every slot and item in a Rust
crate has a <em>canonical path</em> that refers to it from the crate top-level,
as well as a number of shorter <em>relative paths</em> that may also denote it
in inner scopes of the crate. There is no way to define a slot or item without
a canonical path within its crate (with the exception of the crate&rsquo;s implicit
top-level module). Paths have meaning only within a specific
crate. See section <a href="#Ref_002eComp_002eCrate">Ref.Comp.Crate</a>.
</p>
<p>Paths consist of period-separated components. In the simplest form, path
components are identifiers. See section <a href="#Ref_002eLex_002eIdent">Ref.Lex.Ident</a>.
</p>
<p>Two examples of simple paths consisting of only identifier components:
</p><div class="example">
<pre class="example">x;
x.y.z;
</pre></div>

<p>Paths fall into two important categories: <em>names</em> and
<em>lvals</em>.
</p>
<p>A <em>name</em> denotes an item, and is statically resolved to its
referent at compile time.
</p>
<p>An <em>lval</em> denotes a slot, and is statically resolved to a sequence of
memory operations and primitive (arithmetic) expressions required to load or
store to the slot at compile time.
</p>
<p>In some contexts, the Rust grammar accepts a general <em>path</em>, but a
subsequent syntactic restriction requires the path to be an lval or a name. In
other words: in some contexts an lval is required (for example, on the left
hand side of the copy operator, see section <a href="#Ref_002eStmt_002eCopy">Ref.Stmt.Copy</a>) and in other contexts a
name is required (for example, as a type parameter, see section <a href="#Ref_002eItem">Ref.Item</a>). In no
case is the grammar made ambiguous by accepting a general path and restricting
allowed paths to names or lvals after parsing. These restrictions are noted in
the grammar. See section <a href="#Ref_002eGram">Ref.Gram</a>.
</p>
<p>A name component may include type parameters. Type parameters are denoted by
square brackets. Square brackets are used <em>only</em> to denote type
parameters in Rust. If a name component includes a type parameter, the type
parameter must also resolve statically to a type in the environment of the
name. Type parameters are only part of the names of items. See section <a href="#Ref_002eItem">Ref.Item</a>.
</p>
<p>An example of a name with type parameters:
</p><div class="example">
<pre class="example">m.map[int,str];
</pre></div>

<p>An lval component may include an indexing operator. Index operators are
enclosed in parentheses and can include any integral expression. Indexing
operators can only be applied to vectors or strings, and imply a run-time
bounds-check. See section <a href="#Ref_002eType_002eVec">Ref.Type.Vec</a>.
</p>
<p>An example of an lval with a dynamic indexing operator:
</p><div class="example">
<pre class="example">x.y.(1 + v).z;
</pre></div>


<hr>
<a name="Ref_002eGram"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002ePath" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eGram-1"></a>
<h2 class="section">4.3 Ref.Gram</h2>

<p><em>TODO: LL(1), it reads like C, Alef and bits of Napier; formalize here</em>.
</p>

<hr>
<a name="Ref_002eComp"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eGram" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp_002eCrate" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eComp-1"></a>
<h2 class="section">4.4 Ref.Comp</h2>

<p>Rust is a <em>compiled</em> language. Its semantics are divided along a
<em>phase distinction</em> between compile-time and run-time. Those semantic
rules that have a <em>static interpretation</em> govern the success or failure
of compilation. A program that fails to compile due to violation of a
compile-time rule has no defined semantics at run-time; the compiler should
halt with an error report, and produce no executable artifact.
</p>
<p>The compilation model centres on artifacts called <em>crates</em>. Each
compilation is directed towards a single crate in source form, and if
successful produces a single crate in executable form.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eComp_002eCrate">4.4.1 Ref.Comp.Crate</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Units of compilation and linking.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eComp_002eMeta">4.4.2 Ref.Comp.Meta</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Metadata about a crate.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eComp_002eSyntax">4.4.3 Ref.Comp.Syntax</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Syntax extensions.
</td></tr>
</table>


<hr>
<a name="Ref_002eComp_002eCrate"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp_002eMeta" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eComp_002eCrate-1"></a>
<h3 class="subsection">4.4.1 Ref.Comp.Crate</h3>

<p>A <em>crate</em> is a unit of compilation and linking, as well as versioning,
distribution and runtime loading. Crates are defined by <em>crate source
files</em>, which are a type of source file written in a special declarative
language: <em>crate language</em>.<a name="DOCF1" href="#FOOT1">(1)</a> A crate source file describes:
</p>
<ul>
<li> Metadata about the crate, such as author, name, version, and copyright.
</li><li> The source-file and directory modules that make up the crate.
</li><li> The set of syntax extensions to enable for the crate.
</li><li> Any external crates or native modules that the crate imports to its top level.
</li><li> The organization of the crate&rsquo;s internal namespace.
</li><li> The set of names exported from the crate.
</li></ul>

<p>A single crate source file may describe the compilation of a large number of
Rust source files; it is compiled in its entirety, as a single indivisible
unit. The compilation phase attempts to transform a single crate source file,
and its referenced contents, into a single compiled crate. Crate source files
and compiled crates have a 1:1 relationship.
</p>
<p>The syntactic form of a crate is a sequence of <em>directives</em>, some of
which have nested sub-directives.
</p>
<p>A crate defines an implicit top-level anonymous module: within this module,
all members of the crate have canonical path names. See section <a href="#Ref_002ePath">Ref.Path</a>. The
<code>mod</code> directives within a crate file specify sub-modules to include in
the crate: these are either directory modules, corresponding to directories in
the filesystem of the compilation environment, or file modules, corresponding
to Rust source files. The names given to such modules in <code>mod</code> directives
become prefixes of the paths of items and slots defined within any included
Rust source files.
</p>
<p>The <code>use</code> directives within the crate specify <em>other crates</em> to scan
for, locate, import into the crate&rsquo;s module namespace during compilation, and
link against at runtime. Use directives may also occur independently in rust
source files. These directives may specify loose or tight &ldquo;matching
criteria&rdquo; for imported crates, depending on the preferences of the crate
developer. In the simplest case, a <code>use</code> directive may only specify a
symbolic name and leave the task of locating and binding an appropriate crate
to a compile-time heuristic. In a more controlled case, a <code>use</code> directive
may specify any metadata as matching criteria, such as a URI, an author name
or version number, a checksum or even a cryptographic signature, in order to
select an an appropriate imported crate. See section <a href="#Ref_002eComp_002eMeta">Ref.Comp.Meta</a>.
</p>
<p>The compiled form of a crate is a loadable and executable object file full of
machine code, in a standard loadable operating-system format such as ELF, PE
or Mach-O. The loadable object contains extensive DWARF metadata, describing:
</p><ul>
<li> Metadata required for type reflection.
</li><li> The publicly exported module structure of the crate.
</li><li> Any metadata about the crate, defined by <code>meta</code> directives.
</li><li> The crates to dynamically link with at run-time, with matching criteria
derived from the same <code>use</code> directives that guided compile-time imports.
</li></ul>

<p>The <code>syntax</code> directives of a crate are similar to the <code>use</code>
directives, except they govern the syntax extension namespace (accessed
through the syntax-extension sigil <code>#</code>, see section <a href="#Ref_002eComp_002eSyntax">Ref.Comp.Syntax</a>)
available only at compile time. A <code>syntax</code> directive also makes its
extension available to all subsequent directives in the crate file.
</p>
<p>An example of a crate:
</p>
<div class="example">
<pre class="example">// Metadata about this crate
meta (author = &quot;Jane Doe&quot;,
      name = &quot;projx&quot;
      desc = &quot;Project X&quot;,
      ver = &quot;2.5&quot;);

// Import a module.
use std (ver = &quot;1.0&quot;);

// Activate a syntax-extension.
syntax re;

// Define some modules.
mod foo = &quot;foo.rs&quot;;
mod bar {
    mod quux = &quot;quux.rs&quot;;
}
</pre></div>


<hr>
<a name="Ref_002eComp_002eMeta"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp_002eCrate" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp_002eSyntax" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eComp_002eMeta-1"></a>
<h3 class="subsection">4.4.2 Ref.Comp.Meta</h3>

<p>In a crate, a <code>meta</code> directive associates free form key-value metadata
with the crate. This metadata can, in turn, be used in providing partial
matching parameters to syntax-extension loading and crate importing
directives, denoted by <code>syntax</code> and <code>use</code> keywords respectively.
</p>
<p>Alternatively, metadata can serve as a simple form of documentation.
</p>

<hr>
<a name="Ref_002eComp_002eSyntax"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp_002eMeta" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eComp_002eSyntax-1"></a>
<h3 class="subsection">4.4.3 Ref.Comp.Syntax</h3>

<p>Rust provides a notation for <em>syntax extension</em>. The notation is a marked
syntactic form that can appear as an expression, statement or item in the body
of a Rust program, or as a directive in a Rust crate, and which causes the
text enclosed within the marked form to be translated through a named
extension function loaded into the compiler at compile-time.
</p>
<p>The compile-time extension function must return a value of the corresponding
Rust AST type, either an expression node, a statement node or an item
node. <a name="DOCF2" href="#FOOT2">(2)</a>  See section <a href="#Ref_002eLex_002eSyntax">Ref.Lex.Syntax</a>.
</p>
<p>A syntax extension is enabled by a <code>syntax</code> directive, which must occur
in a crate file. When the Rust compiler encounters a <code>syntax</code> directive
in a crate file, it immediately loads the named syntax extension, and makes it
available for all subsequent crate directives within the enclosing block scope
of the crate file, and all Rust source files referenced as modules from the
enclosing block scope of the crate file.
</p>
<p>For example, this extension might provide a syntax for regular
expression literals:
</p>
<div class="example">
<pre class="example">// In a crate file:

// Requests the 're' syntax extension from the compilation environment.
syntax re;

// Also declares an import dependency on the module 're'.
use re;

// Reference to a Rust source file as a module in the crate.
mod foo = &quot;foo.rs&quot;;

&hellip;

// In the source file &quot;foo.rs&quot;, use the #re syntax extension and
// the re module at run-time.
let str s = get_string();
let regex pattern = #re.pat{ aa+b? };
let bool matched = re.match(pattern, s);
</pre></div>


<hr>
<a name="Ref_002eMem"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eComp_002eSyntax" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eAlloc" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eMem-1"></a>
<h2 class="section">4.5 Ref.Mem</h2>

<p>A Rust task&rsquo;s memory consists of a static set of <em>items</em>, a set of tasks
each with its own <em>stack</em>, and a <em>heap</em>. Immutable portions of the
heap may be shared between tasks, mutable portions may not.
</p>
<p>Allocations in the stack and the heap consist of <em>slots</em>.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eMem_002eAlloc">4.5.1 Ref.Mem.Alloc</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Memory allocation model.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eMem_002eOwn">4.5.2 Ref.Mem.Own</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Memory ownership model.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eMem_002eSlot">4.5.3 Ref.Mem.Slot</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Memory containment and reference model.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eMem_002eInit">4.5.4 Ref.Mem.Init</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Initialization state of memory.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eMem_002eAcct">4.5.5 Ref.Mem.Acct</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Memory accounting model.
</td></tr>
</table>


<hr>
<a name="Ref_002eMem_002eAlloc"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eOwn" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eMem_002eAlloc-1"></a>
<h3 class="subsection">4.5.1 Ref.Mem.Alloc</h3>

<p>The <em>items</em> of a program are those functions, iterators, objects, modules
and types that have their value calculated at compile-time and stored uniquely
in the memory image of the rust process. Items are neither dynamically
allocated nor freed.
</p>
<p>A task&rsquo;s <em>stack</em> consists of activation frames automatically allocated on
entry to each function as the task executes. A stack allocation is reclaimed
when control leaves the frame containing it.
</p>
<p>The <em>heap</em> is a general term that describes two separate sets of exterior
allocations: <em>local heap</em> allocations and the <em>shared heap</em>
allocations.
</p>
<p>Exterior allocations of mutable types are <em>local heap</em> allocations,
owned by the task. Such <em>local allocations</em> cannot pass over channels and
do not outlive the task that owns them. When unreferenced, they are collected
using a general (cycle-aware) garbage-collector local to each task. Garbage
collection within a local heap does not interrupt execution of other tasks.
</p>
<p>Exterior allocations of immutable types are <em>shared heap</em> allocations,
and can be multiply-referenced by many different tasks. Such <em>shared
allocations</em> can pass over channels, and live as long as the last task
referencing them. When unreferenced, they are collected immediately using
reference-counting.
</p>



<hr>
<a name="Ref_002eMem_002eOwn"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eAlloc" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eSlot" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eMem_002eOwn-1"></a>
<h3 class="subsection">4.5.2 Ref.Mem.Own</h3>

<p>A task <em>owns</em> all the interior allocations in its stack and <em>local</em>
exterior allocations. A task <em>shares</em> ownership of <em>shared</em> exterior
allocations. A task does not own any items.
</p>
<p><em>Ownership</em> of an allocation means that the owning task is the only task
that can access the allocation.
</p>
<p><em>Sharing</em> of an allocation means that the same allocation may be
concurrently referenced by multiple tasks. The only shared allocations are
those that are immutable.
</p>
<p>When a stack frame is exited, its interior allocations are all released, and
its references to heap allocations (both shared and owned) are dropped.
</p>
<p>When a task finishes, its stack is necessarily empty. The task&rsquo;s interior
slots are released as the task itself is released, and its references to heap
allocations are dropped.
</p>

<hr>
<a name="Ref_002eMem_002eSlot"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eOwn" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eInit" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eMem_002eSlot-1"></a>
<h3 class="subsection">4.5.3 Ref.Mem.Slot</h3>

<p>A <em>slot</em> is a component of an allocation. A slot either holds a value or
the address of another allocation. Every slot has one of three possible
<em>modes</em>.
</p>
<p>The possible <em>modes</em> of a slot are:
</p>
<ul>
<li><br>
</li><li> <em>Interior mode</em>

<p>The slot holds the value of the slot.
</p>
<br>
</li><li> <em>Exterior mode</em>

<p>The slot holds the address of a heap allocation that holds the value of the
slot.
</p>
<p>Exterior slots are indicated by the <em>at</em> sigil <code>@</code>.
</p>
<p>For example, the following code allocates an exterior record, copies it by
counted-reference to a second exterior slot, then modifies the record through
the second exterior slot that points to the same exterior allocation.
</p><div class="example">
<pre class="example">type point3d = rec(int x, int y, int z);
let @point3d pt1 = rec(x=1, y=2, z=3);
let @point3d pt2 = pt1;
pt2.z = 4;
</pre></div>

<br>
</li><li> <em>Alias mode</em>

<p>The slot holds the address of a value. The referenced value may reside within
a stack allocation <em>or</em> a heap allocation.
</p>
<p>Alias slots can <em>only</em> be declared as members of a function or iterator
signature, bound to the lifetime of a stack frame. Alias slots cannot be
declared as members of general data types.
</p>
<p>Alias slots are indicated by the <em>ampersand</em> sigil <code>&amp;</code>.
</p>
<p>The following example function accepts a single read-only alias parameter:
</p><div class="example">
<pre class="example">type point3d = rec(int x, int y, int z);

fn extract_z(&amp;point3d p) -&gt; int {
    ret p.z;
}
</pre></div>

<p>The following example function accepts a single mutable alias
parameter:
</p><div class="example">
<pre class="example">fn incr(mutable &amp;int i) {
    i = i + 1;
}
</pre></div>

</li></ul>


<hr>
<a name="Ref_002eMem_002eInit"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eSlot" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eAcct" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eMem_002eInit-1"></a>
<h3 class="subsection">4.5.4 Ref.Mem.Init</h3>

<p>A slot is either initialized or uninitialized at every point in a program. An
<em>initialized</em> slot is one that holds a value. An <em>uninitialized</em> slot
is one that has not yet had a value written into it, or has had its value
deleted, and so holds undefined memory. The typestate system ensures that an
uninitialized slot cannot be read, but can be written to. A slot becomes
initialized in any statement that writes to it, and remains initialized until
explicitly destroyed or until its enclosing allocation is destroyed.
</p>

<hr>
<a name="Ref_002eMem_002eAcct"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eInit" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eMem_002eAcct-1"></a>
<h3 class="subsection">4.5.5 Ref.Mem.Acct</h3>

<p>Every task belongs to a domain, and that domain tracks the amount of memory
allocated and not yet released by tasks within it. See section <a href="#Ref_002eTask_002eDom">Ref.Task.Dom</a>. Each
domain has a memory budget. The <em>budget</em> of a domain is the maximum amount
of memory that can be simultaneously allocated in the domain. If a task tries
to allocate memory within a domain with an exceeded budget, the task will
receive a signal.
</p>
<p>Within a task, accounting is strictly enforced: all memory allocated through
the runtime library, both user data, sub-domains and runtime-support
structures such as channel and signal queues, are charged to a task&rsquo;s domain.
</p>
<p>When a communication channel crosses from one domain to another, any value
sent over the channel is guaranteed to have been <em>detached</em> from the
domain&rsquo;s memory graph (singly referenced, and/or deep-copied), so its memory
cost is transferred to the receiving domain.
</p>


<hr>
<a name="Ref_002eTask"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eMem_002eAcct" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eComm" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eTask-1"></a>
<h2 class="section">4.6 Ref.Task</h2>

<p>A executing Rust program consists of a tree of tasks. A Rust <em>task</em>
consists of an entry function, a stack, a set of outgoing communication
channels and incoming communication ports, and ownership of some portion of
the heap of a single operating-system process.
</p>
<p>Multiple Rust tasks may coexist in a single operating-system
process. Execution of multiple Rust tasks in a single operating-system process
may be either truly concurrent or interleaved by the runtime scheduler. Rust
tasks are lightweight: each consumes less memory than an operating-system
process, and switching between Rust tasks is faster than switching between
operating-system processes.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eTask_002eComm">4.6.1 Ref.Task.Comm</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Inter-task communication.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eTask_002eLife">4.6.2 Ref.Task.Life</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Task lifecycle and state transitions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eTask_002eDom">4.6.3 Ref.Task.Dom</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Task domains.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eTask_002eSched">4.6.4 Ref.Task.Sched</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Task scheduling model.
</td></tr>
</table>


<hr>
<a name="Ref_002eTask_002eComm"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eLife" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eTask_002eComm-1"></a>
<h3 class="subsection">4.6.1 Ref.Task.Comm</h3>

<p>With the exception of <em>unsafe</em> constructs, Rust tasks are isolated from
interfering with one another&rsquo;s memory directly. Instead of manipulating shared
storage, Rust tasks communicate with one another using a typed, asynchronous,
simplex message-passing system.
</p>
<p>A <em>port</em> is a communication endpoint that can <em>receive</em>
messages. Ports receive messages from channels.
</p>
<p>A <em>channel</em> is a communication endpoint that can <em>send</em>
messages. Channels send messages to ports.
</p>
<p>Each port has a unique identity and cannot be replicated. If a port value is
copied from one slot to another, both slots refer to the <em>same</em> port,
even if the slots are declared as interior-mode. New ports can be constructed
dynamically and stored in data structures.
</p>
<p>Each channel is bound to a port when the channel is constructed, so the
destination port for a channel must exist before the channel itself. A channel
cannot be rebound to a different port from the one it was constructed with.
</p>
<p>Many channels can be bound to the same port, but each channel is bound to a
single port. In other words, channels and ports exist in an N:1 relationship,
N channels to 1 port. <a name="DOCF3" href="#FOOT3">(3)</a>
</p>
<p>Each port and channel can carry only one type of message. The message type is
encoded as a parameter of the channel or port type. The message type of a
channel is equal to the message type of the port it is bound to.
</p>
<p>Messages are sent asynchronously or semi-synchronously. A channel contains a
message queue and asynchronously sending a message merely inserts it into the
channel&rsquo;s queue; message receipt is the responsibility of the receiving task.
</p>
<p>Queued messages in channels are charged to the domain of the <em>sending</em>
task. If too many messages are queued for transmission from a single sending
task, without being received by a receiving task, the sending task may exceed
its memory budget, which causes a run-time signal. To help control this
possibility, a semi-synchronous send operation is possible, which blocks until
there is room in the existing queue and then executes an asynchronous send. A
full <code>flush</code> operation is also available, which blocks until a channel&rsquo;s
queue is <em>empty</em>. A <code>flush</code> does <em>not</em> guarantee that a message
has been <em>received</em> by any particular recipient when the sending task is
unblocked. See section <a href="#Ref_002eStmt_002eFlush">Ref.Stmt.Flush</a>.
</p>
<p>The asynchronous message-send operator is <code>&lt;+</code>. The semi-synchronous
message-send operator is <code>&lt;|</code>. See section <a href="#Ref_002eStmt_002eSend">Ref.Stmt.Send</a>. The message-receive
operator is <code>&lt;-</code>. See section <a href="#Ref_002eStmt_002eRecv">Ref.Stmt.Recv</a>.
</p>

<hr>
<a name="Ref_002eTask_002eLife"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eComm" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eDom" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eTask_002eLife-1"></a>
<h3 class="subsection">4.6.2 Ref.Task.Life</h3>

<p>The <em>lifecycle</em> of a task consists of a finite set of states and events
that cause transitions between the states. The lifecycle states of a task are:
</p>
<ul>
<li> running
</li><li> blocked
</li><li> failing
</li><li> dead
</li></ul>

<p>A task begins its lifecycle &ndash; once it has been spawned &ndash; in the
<em>running</em> state. In this state it executes the statements of its entry
function, and any functions called by the entry function.
</p>
<p>A task may transition from the <em>running</em> state to the <em>blocked</em>
state any time it executes a communication statement on a port or channel that
cannot be immediately completed.  When the communication statement can be
completed &ndash; when a message arrives at a sender, or a queue drains
sufficiently to complete a semi-synchronous send &ndash; then the blocked task will
unblock and transition back to <em>running</em>.
</p>
<p>A task may transition to the <em>failing</em> state at any time, due to an
un-trapped signal or the execution of a <code>fail</code> statement. Once
<em>failing</em>, a task unwinds its stack and transitions to the <em>dead</em>
state. Unwinding the stack of a task is done by the task itself, on its own
control stack. If a value with a destructor is freed during unwinding, the
code for the destructor is run, also on the task&rsquo;s control stack. If the
destructor code causes any subsequent state transitions, the task of unwinding
and failing may suspend temporarily, and may involve (recursive) unwinding of
the stack of a failed destructor. Nonetheless, the outermost unwinding
activity will continue until the stack is unwound and the task transitions to
the <em>dead</em> state. There is no way to &ldquo;recover&rdquo; from task failure.
</p>
<p>A task in the <em>dead</em> state cannot transition to other states; it exists
only to have its termination status inspected by other tasks, and/or to await
reclamation when the last reference to it drops.
</p>

<hr>
<a name="Ref_002eTask_002eDom"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eLife" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eSched" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eTask_002eDom-1"></a>
<h3 class="subsection">4.6.3 Ref.Task.Dom</h3>

<p>Every task belongs to a domain. A <em>domain</em> is a structure that owns tasks,
schedules tasks, tracks memory allocation within tasks and manages access to
runtime services on behalf of tasks.
</p>
<p>Typically each domain runs on a separate operating-system <em>thread</em>, or
within an isolated operating-system <em>process</em>. An easy way to think of a
domain is as an abstraction over either an operating-system thread <em>or</em> a
process.
</p>
<p>The key feature of a domain is that it isolates memory references created by
the Rust tasks within it. No Rust task can refer directly to memory outside
its domain.
</p>
<p>Tasks can own sub-domains, which in turn own their own tasks. Every domain
owns one <em>root task</em>, which is the root of the tree of tasks owned by the
domain.
</p>

<hr>
<a name="Ref_002eTask_002eSched"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eDom" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eTask_002eSched-1"></a>
<h3 class="subsection">4.6.4 Ref.Task.Sched</h3>

<p>Every task is <em>scheduled</em> within its domain. See section <a href="#Ref_002eTask_002eDom">Ref.Task.Dom</a>. The
currently scheduled task is given a finite <em>time slice</em> in which to
execute, after which it is <em>descheduled</em> at a loop-edge or similar
preemption point, and another task within the domain is scheduled,
pseudo-randomly.
</p>
<p>An executing task can <code>yield</code> control at any time, which deschedules it
immediately. Entering any other non-executing state (blocked, dead) similarly
deschedules the task.
</p>

<hr>
<a name="Ref_002eItem"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eTask_002eSched" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem-1"></a>
<h2 class="section">4.7 Ref.Item</h2>

<p>An <em>item</em> is a component of a module. Items are entirely determined at
compile-time, remain constant during execution, and may reside in read-only
memory.
</p>
<p>There are 5 primary kinds of item: modules, functions, iterators, objects and
types.
</p>
<p>All items form an implicit scope for the declaration of sub-items. In other
words, within a function, object or iterator, declarations of items can (in
many cases) be mixed with the statements, control blocks, and similar
artifacts that otherwise compose the item body. The meaning of these scoped
items is the same as if the item was declared outside the scope, except that
the item&rsquo;s <em>path name</em> within the module namespace is qualified by the
name of the enclosing item. The exact locations in which sub-items may be
declared is given by the grammar.  See section <a href="#Ref_002eGram">Ref.Gram</a>.
</p>
<p>Functions, iterators, objects and types may be <em>parametrized</em> by
type. Type parameters are given as a comma-separated list of identifiers
enclosed in square brackets (<code>[]</code>), after the name of the item and before
its definition.  The type parameters of an item are part of the name, not the
type of the item; in order to refer to the type-parametrized item, a
referencing name must in general provide type arguments as a list of
comma-separated types enclosed within square brackets (though the
type-inference system can often infer such argument types from context). There
are no general parametric types.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eMod">4.7.1 Ref.Item.Mod</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Items defining modules.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eFn">4.7.2 Ref.Item.Fn</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Items defining functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eIter">4.7.3 Ref.Item.Iter</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Items defining iterators.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eObj">4.7.4 Ref.Item.Obj</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Items defining objects.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eType">4.7.5 Ref.Item.Type</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Items defining the types of values and slots.
</td></tr>
</table>


<hr>
<a name="Ref_002eItem_002eMod"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod_002eImport" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eMod-1"></a>
<h3 class="subsection">4.7.1 Ref.Item.Mod</h3>

<p>A <em>module item</em> contains declarations of other <em>items</em>. The items
within a module may be functions, modules, objects or types. These
declarations have both static and dynamic interpretation. The purpose of a
module is to organize <em>names</em> and control <em>visibility</em>. Modules are
declared with the keyword <code>mod</code>.
</p>
<p>An example of a module:
</p><div class="example">
<pre class="example">mod math {
    type complex = (f64,f64);
    fn sin(f64) -&gt; f64 {
        &hellip;
    }
    fn cos(f64) -&gt; f64 {
        &hellip;
    }
    fn tan(f64) -&gt; f64 {
        &hellip;
    }
    &hellip;
}
</pre></div>

<p>Modules may also include any number of <em>import and export
declarations</em>. These declarations must precede any module item declarations
within the module, and control the visibility of names both within the module
and outside of it.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eMod_002eImport">4.7.1.1 Ref.Item.Mod.Import</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Declarations for module-local synonyms.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eItem_002eMod_002eExport">4.7.1.2 Ref.Item.Mod.Export</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Declarations for restricting visibility.
</td></tr>
</table>


<hr>
<a name="Ref_002eItem_002eMod_002eImport"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod_002eExport" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eMod_002eImport-1"></a>
<h4 class="subsubsection">4.7.1.1 Ref.Item.Mod.Import</h4>

<p>An <em>import declaration</em> creates one or more local name bindings synonymous
with some other name. Usually an import declaration is used to shorten the
path required to refer to a module item.
</p>
<p><em>Note</em>: unlike many languages, Rust&rsquo;s <code>import</code> declarations do
<em>not</em> declare linkage-dependency with external crates. Linkage
dependencies are independently declared with <code>use</code>
declarations. See section <a href="#Ref_002eComp_002eCrate">Ref.Comp.Crate</a>.
</p>
<p>An example of an import:
</p><div class="example">
<pre class="example">import std.math.sin;
fn main() {
    // Equivalent to 'log std.math.sin(1.0);'
    log sin(1.0);
}
</pre></div>


<hr>
<a name="Ref_002eItem_002eMod_002eExport"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod_002eImport" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eFn" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eMod_002eExport-1"></a>
<h4 class="subsubsection">4.7.1.2 Ref.Item.Mod.Export</h4>

<p>An <em>export declaration</em> restricts the set of local declarations within a
module that can be accessed from code outside the module. By default, all
local declarations in a module are exported. If a module contains an export
declaration, this declaration replaces the default export with the export
specified.
</p>
<p>An example of an export:
</p><div class="example">
<pre class="example">mod foo {
    export primary;

    fn primary() {
        helper(1, 2);
        helper(3, 4);
    }

    fn helper(int x, int y) {
        &hellip;
    }
}

fn main() {
    foo.primary();  // Will compile.
    foo.helper(2,3) // ERROR: will not compile.
}
</pre></div>




<hr>
<a name="Ref_002eItem_002eFn"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eMod_002eExport" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eIter" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eFn-1"></a>
<h3 class="subsection">4.7.2 Ref.Item.Fn</h3>

<p>A <em>function item</em> defines a sequence of statements associated with a name
and a set of parameters. Functions are declared with the keyword
<code>fn</code>. Functions declare a set of <em>input slots</em> as parameters,
through which the caller passes arguments into the function, and an
<em>output slot</em> through which the function passes results back to the
caller.
</p>
<p>A function may also be copied into a first class <em>value</em>, in which case
the value has the corresponding <em>function type</em>, and can be used
otherwise exactly as a function item (with a minor additional cost of calling
the function, as such a call is indirect). See section <a href="#Ref_002eType_002eFn">Ref.Type.Fn</a>.
</p>
<p>Every control path in a function ends with either a <code>ret</code> or <code>be</code>
statement. If a control path lacks a <code>ret</code> statement in source code, an
implicit <code>ret</code> statement is appended to the end of the control path
during compilation, returning the implicit <code>()</code> value.
</p>
<p>A function may have an <em>effect</em>, which may be either <code>io</code>,
<code>state</code>, <code>unsafe</code>. If no effect is specified, the function is said
to be <em>pure</em>.
</p>
<p>Any pure boolean function is also called a <em>predicate</em>, and may be used
as part of the static typestate system. See section <a href="#Ref_002eStmt_002eStat_002eConstr">Ref.Stmt.Stat.Constr</a>.
</p>
<p>An example of a function:
</p><div class="example">
<pre class="example">fn add(int x, int y) -&gt; int {
    ret x + y;
}
</pre></div>


<hr>
<a name="Ref_002eItem_002eIter"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eFn" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eObj" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eIter-1"></a>
<h3 class="subsection">4.7.3 Ref.Item.Iter</h3>

<p>Iterators are function-like items that can <code>put</code> multiple values during
their execution before returning or tail-calling.
</p>
<p>Putting a value is similar to returning a value &ndash; the argument to <code>put</code>
is copied into the caller&rsquo;s frame and control transfers back to the caller &ndash;
but the iterator frame is only <em>suspended</em> during the put, and will be
<em>resumed</em> at the statement after the <code>put</code>, on the next iteration of
the caller&rsquo;s loop.
</p>
<p>The output type of an iterator is the type of value that the function will
<code>put</code>, before it eventually executes a <code>ret</code> or <code>be</code> statement
of type <code>()</code> and completes its execution.
</p>
<p>An iterator can only be called in the loop header of a matching <code>for
each</code> loop or as the argument in a <code>put each</code> statement.
See section <a href="#Ref_002eStmt_002eForeach">Ref.Stmt.Foreach</a>.
</p>
<p>An example of an iterator:
</p><div class="example">
<pre class="example">iter range(int lo, int hi) -&gt; int {
    let int i = lo;
    while (i &lt; hi) {
        put i;
        i = i + 1;
    }
}

let int sum = 0;
for each (int x = range(0,100)) {
    sum += x;
}
</pre></div>



<hr>
<a name="Ref_002eItem_002eObj"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eIter" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eType" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eObj-1"></a>
<h3 class="subsection">4.7.4 Ref.Item.Obj</h3>

<p>An <em>object item</em> defines the <em>state</em> and <em>methods</em> of a set of
<em>object values</em>. Object values have object types.  See section <a href="#Ref_002eType_002eObj">Ref.Type.Obj</a>.
</p>
<p>An <em>object item</em> declaration &ndash; in addition to providing a scope for
state and method declarations &ndash; implicitly declares a static function called
the <em>object constructor</em>, as well as a named <em>object type</em>. The name
given to the object item is resolved to a type when used in type context, or a
constructor function when used in value context (such as a call).
</p>
<p>Example of an object item:
</p><div class="example">
<pre class="example">obj counter(int state) {
    fn incr() {
       state += 1;
    }
    fn get() -&gt; int {
       ret state;
    }
}

let counter c = counter(1);

c.incr();
c.incr();
check (c.get() == 3);
</pre></div>


<hr>
<a name="Ref_002eItem_002eType"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eObj" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eItem_002eType-1"></a>
<h3 class="subsection">4.7.5 Ref.Item.Type</h3>

<p>A <em>type</em> defines an <em>interpretation</em> of a value in
memory. See section <a href="#Ref_002eType">Ref.Type</a>. Types are declared with the keyword <code>type</code>. A
type&rsquo;s interpretation is used for the values held in any slot with that
type. See section <a href="#Ref_002eMem_002eSlot">Ref.Mem.Slot</a>. The interpretation of a value includes:
</p>
<ul>
<li> Whether the value is composed of sub-values or is indivisible.
</li><li> Whether the value represents textual or numerical information.
</li><li> Whether the value represents integral or floating-point information.
</li><li> The sequence of memory operations required to access the value.
</li><li> Whether the value is mutable or immutable.
</li></ul>

<p>For example, the type <code>rec(u8 x, u8 y)</code> defines the
interpretation of values that are composite records, each containing
two unsigned two&rsquo;s complement 8-bit integers accessed through the
components <code>x</code> and <code>y</code>, and laid out in memory with the
<code>x</code> component preceding the <code>y</code> component.
</p>
<p>Some types are <em>recursive</em>. A recursive type is one that includes
its own definition as a component, by named reference. Recursive types
are restricted to occur only within a single crate, and only through a
restricted form of <code>tag</code> type. See section <a href="#Ref_002eType_002eTag">Ref.Type.Tag</a>.
</p>

<hr>
<a name="Ref_002eType"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eItem_002eType" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eAny" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType-1"></a>
<h2 class="section">4.8 Ref.Type</h2>

<p>Every slot and value in a Rust program has a type. The <em>type</em> of a
<em>value</em> defines the interpretation of the memory holding it. The type of
a <em>slot</em> may also include constraints. See section <a href="#Ref_002eType_002eConstr">Ref.Type.Constr</a>.
</p>
<p>Built-in types and type-constructors are tightly integrated into the language,
in nontrivial ways that are not possible to emulate in user-defined
types. User-defined types have limited capabilities. In addition, every
built-in type or type-constructor name is reserved as a <em>keyword</em> in
Rust; they cannot be used as user-defined identifiers in any context.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eAny">4.8.1 Ref.Type.Any</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                An open sum of every possible type.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eMach">4.8.2 Ref.Type.Mach</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Machine-level types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eInt">4.8.3 Ref.Type.Int</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                The machine-dependent integer types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002ePrim">4.8.4 Ref.Type.Prim</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Primitive types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eBig">4.8.5 Ref.Type.Big</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                The arbitrary-precision integer type.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eText">4.8.6 Ref.Type.Text</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Strings and characters.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eRec">4.8.7 Ref.Type.Rec</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Labeled products of heterogeneous types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eTup">4.8.8 Ref.Type.Tup</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Unlabeled products of homogeneous types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eVec">4.8.9 Ref.Type.Vec</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Open products of homogeneous types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eTag">4.8.10 Ref.Type.Tag</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Disjoint sums of heterogeneous types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eFn">4.8.11 Ref.Type.Fn</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Subroutine types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eIter">4.8.12 Ref.Type.Iter</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Scoped coroutine types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002ePort">4.8.13 Ref.Type.Port</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Unique inter-task message-receipt endpoints.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eChan">4.8.14 Ref.Type.Chan</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Copyable inter-task message-send capabilities.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eTask">4.8.15 Ref.Type.Task</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               General coroutine-instance types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eObj">4.8.16 Ref.Type.Obj</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Abstract types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eConstr">4.8.17 Ref.Type.Constr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">             Constrained types.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eType_002eType">4.8.18 Ref.Type.Type</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Types describing types.
</td></tr>
</table>


<hr>
<a name="Ref_002eType_002eAny"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eMach" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eAny-1"></a>
<h3 class="subsection">4.8.1 Ref.Type.Any</h3>

<p>The type <code>any</code> is the union of all possible Rust types. A value of type
<code>any</code> is represented in memory as a pair consisting of an exterior value
of some non-<code>any</code> type <var>T</var> and a reflection of the type <var>T</var>.
</p>
<p>Values of type <code>any</code> can be used in an <code>alt type</code> statement, in
which the reflection is used to select a block corresponding to a particular
type extraction. See section <a href="#Ref_002eStmt_002eAlt">Ref.Stmt.Alt</a>.
</p>

<hr>
<a name="Ref_002eType_002eMach"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eAny" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eInt" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eMach-1"></a>
<h3 class="subsection">4.8.2 Ref.Type.Mach</h3>

<p>The machine types are the following:
</p>
<ul>
<li>
The unsigned two&rsquo;s complement word types <code>u8</code>, <code>u16</code>, <code>u32</code> and
<code>u64</code>, with values drawn from the integer intervals
[0, 2<sup>8</sup>-1],
[0, 2<sup>16</sup>-1],
[0, 2<sup>32</sup>-1] and
[0, 2<sup>64</sup>-1] respectively.
</li><li>
The signed two&rsquo;s complement word types <code>i8</code>, <code>i16</code>, <code>i32</code> and
<code>i64</code>, with values drawn from the integer intervals
[-(2<sup>7</sup>), 2<sup>7</sup>-1],
[-(2<sup>15</sup>), 2<sup>15</sup>-1],
[-(2<sup>31</sup>), 2<sup>31</sup>-1] and
[-(2<sup>63</sup>), 2<sup>63</sup>-1] respectively.
</li><li>
The IEEE 754 single-precision and double-precision floating point types:
<code>f32</code> and <code>f64</code>, respectively.
</li></ul>


<hr>
<a name="Ref_002eType_002eInt"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eMach" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002ePrim" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eInt-1"></a>
<h3 class="subsection">4.8.3 Ref.Type.Int</h3>


<p>The Rust type <code>uint</code><a name="DOCF4" href="#FOOT4">(4)</a> is a two&rsquo;s complement unsigned integer type with with
target-machine-dependent size. Its size, in bits, is equal to the number of
bits required to hold any memory address on the target machine.
</p>
<p>The Rust type <code>int</code><a name="DOCF5" href="#FOOT5">(5)</a> is a two&rsquo;s complement signed integer type with
target-machine-dependent size. Its size, in bits, is equal to the size of the
rust type <code>uint</code> on the same target machine.
</p>



<hr>
<a name="Ref_002eType_002ePrim"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eInt" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eBig" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002ePrim-1"></a>
<h3 class="subsection">4.8.4 Ref.Type.Prim</h3>

<p>The primitive types are the following:
</p>
<ul>
<li>
The &ldquo;nil&rdquo; type <code>()</code>, having the single &ldquo;nil&rdquo; value
<code>()</code>.<a name="DOCF6" href="#FOOT6">(6)</a>
</li><li>
The boolean type <code>bool</code> with values <code>true</code> and <code>false</code>.
</li><li>
The machine types.
</li><li>
The machine-dependent integer types.
</li></ul>



<hr>
<a name="Ref_002eType_002eBig"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002ePrim" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eText" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eBig-1"></a>
<h3 class="subsection">4.8.5 Ref.Type.Big</h3>

<p>The Rust type <code>big</code><a name="DOCF7" href="#FOOT7">(7)</a> is an arbitrary precision integer type that
fits in a machine word <em>when possible</em> and transparently expands to a
boxed &ldquo;big integer&rdquo; allocated in the run-time heap when it overflows or
underflows outside of the range of a machine word.
</p>
<p>A Rust <code>big</code> grows to accommodate extra binary digits as they are needed,
by taking extra memory from the memory budget available to each Rust task, and
should only exhaust its range due to memory exhaustion.
</p>

<hr>
<a name="Ref_002eType_002eText"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eBig" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eRec" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eText-1"></a>
<h3 class="subsection">4.8.6 Ref.Type.Text</h3>

<p>The types <code>char</code> and <code>str</code> hold textual data.
</p>
<p>A value of type <code>char</code> is a Unicode character, represented as a 32-bit
unsigned word holding a UCS-4 codepoint.
</p>
<p>A value of type <code>str</code> is a Unicode string, represented as a vector of
8-bit unsigned bytes holding a sequence of UTF-8 codepoints.
</p>

<hr>
<a name="Ref_002eType_002eRec"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eText" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eTup" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eRec-1"></a>
<h3 class="subsection">4.8.7 Ref.Type.Rec</h3>

<p>The record type-constructor <code>rec</code> forms a new heterogeneous product of
slots.<a name="DOCF8" href="#FOOT8">(8)</a> Fields of
a <code>rec</code> type are accessed by name and are arranged in memory in the order
specified by the <code>rec</code> type.
</p>
<p>An example of a <code>rec</code> type and its use:
</p><div class="example">
<pre class="example">type point = rec(int x, int y);
let point p = rec(x=10, y=11);
let int px = p.x;
</pre></div>


<hr>
<a name="Ref_002eType_002eTup"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eRec" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eVec" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eTup-1"></a>
<h3 class="subsection">4.8.8 Ref.Type.Tup</h3>

<p>The tuple type-constructor <code>tup</code> forms a new heterogeneous product of
slots exactly as the <code>rec</code> type-constructor does, with the difference
that tuple slots are automatically assigned implicit field names, given by
ascending integers prefixed by the underscore character: <code>_0</code>, <code>_1</code>,
<code>_2</code>, etc. The fields of a tuple are laid out in memory contiguously,
like a record, in order specified by the tuple type.
</p>
<p>An example of a tuple type and its use:
</p><div class="example">
<pre class="example">type pair = tup(int,str);
let pair p = tup(10,&quot;hello&quot;);
check (p._0 == 10);
p._1 = &quot;world&quot;;
check (p._1 == &quot;world&quot;);
</pre></div>



<hr>
<a name="Ref_002eType_002eVec"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eTup" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eTag" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eVec-1"></a>
<h3 class="subsection">4.8.9 Ref.Type.Vec</h3>

<p>The vector type-constructor <code>vec</code> represents a homogeneous array of
slots. A vector has a fixed size, and may or may not have mutable member
slots.  If the slots of a vector are mutable, the vector is a <em>state</em>
type.
</p>
<p>Vectors can be sliced. A slice expression builds a new vector by copying a
contiguous range &ndash; given by a pair of indices representing a half-open
interval &ndash; out of the sliced vector.
</p>
<p>And example of a <code>vec</code> type and its use:
</p><div class="example">
<pre class="example">let vec[int] v = vec(7, 5, 3);
let int i = v.(2);
let vec[int] v2 = v.(0,1); // Form a slice.
</pre></div>

<p>Vectors always <em>allocate</em> a storage region sufficient to store the first
power of two worth of elements greater than or equal to the size of the
largest slice sharing the storage. This behaviour supports idiomatic in-place
&ldquo;growth&rdquo; of a mutable slot holding a vector:
</p>
<div class="example">
<pre class="example">let mutable vec[int] v = vec(1, 2, 3);
v += vec(4, 5, 6);
</pre></div>

<p>Normal vector concatenation causes the allocation of a fresh vector to hold
the result; in this case, however, the slot holding the vector recycles the
underlying storage in-place (since the reference-count of the underlying
storage is equal to 1).
</p>
<p>All accessible elements of a vector are always initialized, and access to a
vector is always bounds-checked.
</p>


<hr>
<a name="Ref_002eType_002eTag"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eVec" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eFn" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eTag-1"></a>
<h3 class="subsection">4.8.10 Ref.Type.Tag</h3>

<p>The <code>tag</code> type-constructor forms new heterogeneous disjoint sum
types.<a name="DOCF9" href="#FOOT9">(9)</a> A <code>tag</code> type consists
of a number of <em>variants</em>, each of which is independently named and takes
an optional tuple of arguments.
</p>
<p>The variants of a <code>tag</code> type may be recursive: that is, the definition of
a <code>tag</code> type may refer to type definitions that include the defined
<code>tag</code> type itself. Such recursion has restrictions:
</p><ul>
<li> Recursive types can only be introduced through <code>tag</code> types.
</li><li> A recursive <code>tag</code> type must have at least one non-recursive
variant (in order to give the recursion a basis case).
</li><li> The recursive slots of recursive variants must be <em>exterior</em>
slots (in order to bound the in-memory size of the variant).
</li><li> Recursive type definitions can cross module boundaries, but not module
<em>visibility</em> boundaries, nor crate boundaries (in order to simplify the
module system).
</li></ul>

<p>An example of a <code>tag</code> type and its use:
</p><div class="example">
<pre class="example">type animal = tag(dog, cat);
let animal a = dog;
a = cat;
</pre></div>

<p>An example of a <em>recursive</em> <code>tag</code> type and its use:
</p><div class="example">
<pre class="example">type list[T] = tag(nil,
                   cons(T, @list[T]));
let list[int] a = cons(7, cons(13, nil));
</pre></div>



<hr>
<a name="Ref_002eType_002eFn"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eTag" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eIter" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eFn-1"></a>
<h3 class="subsection">4.8.11 Ref.Type.Fn</h3>

<p>The function type-constructor <code>fn</code> forms new function types. A function
type consists of a sequence of input slots, an optional set of input
constraints (see section <a href="#Ref_002eStmt_002eStat_002eConstr">Ref.Stmt.Stat.Constr</a>), an output slot, and an
<em>effect</em>. See section <a href="#Ref_002eItem_002eFn">Ref.Item.Fn</a>.
</p>
<p>An example of a <code>fn</code> type:
</p><div class="example">
<pre class="example">fn add(int x, int y) -&gt; int {
  ret x + y;
}

let int x = add(5,7);

type binop = fn(int,int) -&gt; int;
let binop bo = add;
x = bo(5,7);
</pre></div>


<hr>
<a name="Ref_002eType_002eIter"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eFn" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002ePort" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eIter-1"></a>
<h3 class="subsection">4.8.12 Ref.Type.Iter</h3>

<p>The iterator type-constructor <code>iter</code> forms new iterator types. An
iterator type consists a sequence of input slots, an optional set of input
constraints, an output slot, and an <em>effect</em>. See section <a href="#Ref_002eItem_002eIter">Ref.Item.Iter</a>.
</p>
<p>An example of an <code>iter</code> type:
</p><div class="example">
<pre class="example">iter range(int x, int y) -&gt; int {
  while (x &lt; y) {
    put x;
    x += 1;
  }
}

for each (int i = range(5,7)) {
  &hellip;;
}
</pre></div>



<hr>
<a name="Ref_002eType_002ePort"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eIter" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eChan" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002ePort-1"></a>
<h3 class="subsection">4.8.13 Ref.Type.Port</h3>

<p>The port type-constructor <code>port</code> forms types that describe ports. A port
is the <em>receiving end</em> of a typed, asynchronous, simplex inter-task
communication facility. See section <a href="#Ref_002eTask_002eComm">Ref.Task.Comm</a>. A <code>port</code> type takes a
single type parameter, denoting the type of value that can be received from a
<code>port</code> value of that type.
</p>
<p>Ports are modeled as mutable native types with built-in meaning to the
language. They cannot be transmitted over channels or otherwise replicated,
and are always local to the task that creates them.
</p>
<p>An example of a <code>port</code> type:
</p><div class="example">
<pre class="example">type port[vec[str]] svp;
let svp p = get_port();
let vec[str] v;
v &lt;- p;
</pre></div>


<hr>
<a name="Ref_002eType_002eChan"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002ePort" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eTask" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eChan-1"></a>
<h3 class="subsection">4.8.14 Ref.Type.Chan</h3>

<p>The channel type-constructor <code>chan</code> forms types that describe channels. A
channel is the <em>sending end</em> of a typed, asynchronous, simplex inter-task
communication facility. See section <a href="#Ref_002eTask_002eComm">Ref.Task.Comm</a>. A <code>chan</code> type takes a
single type parameter, denoting the type of value that can be sent to a
channel of that type.
</p>
<p>Channels are immutable, and can be transmitted over channels to other
tasks. They are modeled as immutable native types with built-in meaning to the
language.
</p>
<p>When a task sends a message into a channel, the task forms an outgoing queue
associated with that channel. The per-task queue <em>associated</em> with a
channel can be indirectly manipulated by the task, but is <em>not</em> otherwise
considered &ldquo;part of&rdquo; to the channel: the queue is &ldquo;part of&rdquo; the
<em>sending task</em>. Sending a channel to another task does not copy the queue
associated with the channel.
</p>
<p>Channels are also <em>weak</em>: a channel is directly coupled to a particular
destination port on a particular task, but does not keep that port or task
<em>alive</em>. A channel may therefore fail to operate at any moment. If a task
sends to a channel that is connected to a nonexistent port, it receives a
signal.
</p>
<p>An example of a <code>chan</code> type:
</p><div class="example">
<pre class="example">type chan[vec[str]] svc;
let svc c = get_chan();
let vec[str] v = vec(&quot;hello&quot;, &quot;world&quot;);
c &lt;| v;
</pre></div>


<hr>
<a name="Ref_002eType_002eTask"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eChan" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eObj" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eTask-1"></a>
<h3 class="subsection">4.8.15 Ref.Type.Task</h3>

<p>The task type <code>task</code> describes values that are <em>live
tasks</em>.
</p>
<p>Tasks form an <em>ownership tree</em> in which each task (except the root task)
is directly owned by exactly one parent task. The purpose of a variable of
<code>task</code> type is to manage the lifecycle of the associated
task. Communication is carried out solely using channels and ports.
</p>
<p>Like ports, tasks are modeled as mutable native types with built-in meaning to
the language. They cannot be transmitted over channels or otherwise
replicated, and are always local to the task that spawns them.
</p>
<p>If all references to a task are dropped (due to the release of any slots
holding those references), the released task immediately fails.
See section <a href="#Ref_002eTask_002eLife">Ref.Task.Life</a>.
</p>


<hr>
<a name="Ref_002eType_002eObj"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eTask" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eConstr" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eObj-1"></a>
<h3 class="subsection">4.8.16 Ref.Type.Obj</h3>

<p>A <em>object type</em> describes values of abstract type, that carry some hidden
<em>fields</em> and are accessed through a set of un-ordered
<em>methods</em>. Every object item (see section <a href="#Ref_002eItem_002eObj">Ref.Item.Obj</a>) implicitly declares
an object type carrying methods with types derived from all the methods of the
object item.
</p>
<p>Object types can also be declared in isolation, independent of any object item
declaration. Such a &ldquo;plain&rdquo; object type can be used to describe an interface
that a variety of particular objects may conform to, by supporting a superset
of the methods.
</p>
<p>An object type that can contain a state must be declared as a <code>state obj</code>
like any other state type. And similarly a method type that performs I/O or
makes native calls must be declared <code>io</code> or <code>unsafe</code>, like any other
function.
</p>
<p>Moreover, <em>all</em> methods of a state object are implicitly state functions &ndash; as
they all bind the same mutable state field(s) &ndash; so implicitly have an effect
lower than <code>io</code>. It is therefore unnecessary to declare methods within a
state object type (or state object item) as <code>io</code>.
</p>
<p>An example of an object type with two separate object items supporting it, and
a client function using both items via the object type:
</p>
<div class="example">
<pre class="example">
state type taker =
    state obj {
        fn take(int);
    };

state obj adder(mutable int x) {
    fn take(int y) {
        x += y;
    }
}

obj sender(chan[int] c) {
    io fn take(int z) {
        c &lt;| z;
    }
}

fn give_ints(taker t) {
    t.take(1);
    t.take(2);
    t.take(3);
}

let port[int] p = port();

let taker t1 = adder(0);
let taker t2 = sender(chan(p));

give_ints(t1);
give_ints(t2);

</pre></div>




<hr>
<a name="Ref_002eType_002eConstr"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eObj" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eType" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eConstr-1"></a>
<h3 class="subsection">4.8.17 Ref.Type.Constr</h3>

<p>A <em>constrained type</em> is a type that carries a <em>formal constraint</em>
(see section <a href="#Ref_002eStmt_002eStat_002eConstr">Ref.Stmt.Stat.Constr</a>), which is similar to a normal constraint except
that the <em>base name</em> of any slots mentioned in the constraint must be the
special <em>formal symbol</em> <em>*</em>.
</p>
<p>When a constrained type is instantiated in a particular slot declaration, the
formal symbol in the constraint is replaced with the name of the declared slot
and the resulting constraint is checked immediately after the slot is
declared. See section <a href="#Ref_002eStmt_002eCheck">Ref.Stmt.Check</a>.
</p>
<p>An example of a constrained type with two separate instantiations:
</p><div class="example">
<pre class="example">type ordered_range = rec(int low, int high) : less_than(*.low, *.high);

let ordered_range rng1 = rec(low=5, high=7);
// implicit: 'check less_than(rng1.low, rng1.high);'

let ordered_range rng2 = rec(low=15, high=17);
// implicit: 'check less_than(rng2.low, rng2.high);'
</pre></div>


<hr>
<a name="Ref_002eType_002eType"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eConstr" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eExpr" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eType_002eType-1"></a>
<h3 class="subsection">4.8.18 Ref.Type.Type</h3>

<p><em>TODO</em>.
</p>

<hr>
<a name="Ref_002eExpr"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eType_002eType" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eExpr-1"></a>
<h2 class="section">4.9 Ref.Expr</h2>

<p>Rust has two kinds of expressions: <em>parsed expressions</em> and
<em>primitive expressions</em>.  The former are syntactic sugar and are
eliminated during parsing. The latter are very minimal, consisting only of
paths and primitive literals, possibly combined via a single level
(non-recursive) unary or binary machine-level operation (ALU or
FPU). See section <a href="#Ref_002ePath">Ref.Path</a>.
</p>
<p>For the most part, Rust semantics are defined in terms of <em>statements</em>,
which parsed expressions are desugared to. The desugaring is defined in the
grammar. See section <a href="#Ref_002eGram">Ref.Gram</a>. The residual primitive statements appear only in the
right hand side of copy statements, See section <a href="#Ref_002eStmt_002eCopy">Ref.Stmt.Copy</a>.
</p>

<hr>
<a name="Ref_002eStmt"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eExpr" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt-1"></a>
<h2 class="section">4.10 Ref.Stmt</h2>

<p>A <em>statement</em> is a component of a block, which is in turn a components of
an outer block, a function or an iterator. When a function is spawned into a
task, the task <em>executes</em> statements in an order determined by the body
of the enclosing structure. Each statement causes the task to perform certain
actions.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat">4.10.1 Ref.Stmt.Stat</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               The static typestate system of statement analysis.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eDecl">4.10.2 Ref.Stmt.Decl</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement declaring an item or slot.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eCopy">4.10.3 Ref.Stmt.Copy</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for copying a value between two slots.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eSpawn">4.10.4 Ref.Stmt.Spawn</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statements for creating new tasks.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eSend">4.10.5 Ref.Stmt.Send</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statements for sending a value into a channel.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eFlush">4.10.6 Ref.Stmt.Flush</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement for flushing a channel queue.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eRecv">4.10.7 Ref.Stmt.Recv</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for receiving a value from a channel.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eCall">4.10.8 Ref.Stmt.Call</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for calling a function.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eBind">4.10.9 Ref.Stmt.Bind</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for binding arguments to functions.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eRet">4.10.10 Ref.Stmt.Ret</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Statement for stopping and producing a value.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eBe">4.10.11 Ref.Stmt.Be</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Statement for stopping and executing a tail call.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002ePut">4.10.12 Ref.Stmt.Put</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Statement for pausing and producing a value.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eFail">4.10.13 Ref.Stmt.Fail</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for causing task failure.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eLog">4.10.14 Ref.Stmt.Log</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Statement for logging values to diagnostic buffers.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eNote">4.10.15 Ref.Stmt.Note</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for logging values during failure.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eWhile">4.10.16 Ref.Stmt.While</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement for simple conditional looping.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eBreak">4.10.17 Ref.Stmt.Break</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement for terminating a loop.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eCont">4.10.18 Ref.Stmt.Cont</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">               Statement for terminating a single loop iteration.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eFor">4.10.19 Ref.Stmt.For</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Statement for looping over strings and vectors.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eForeach">4.10.20 Ref.Stmt.Foreach</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Statement for looping via an iterator.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eIf">4.10.21 Ref.Stmt.If</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Statement for simple conditional branching.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eAlt">4.10.22 Ref.Stmt.Alt</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Statement for complex conditional branching.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eProve">4.10.23 Ref.Stmt.Prove</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement for static assertion of typestate.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eCheck">4.10.24 Ref.Stmt.Check</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement for dynamic assertion of typestate.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eIfCheck">4.10.25 Ref.Stmt.IfCheck</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">            Statement for dynamic testing of typestate.
</td></tr>
</table>


<hr>
<a name="Ref_002eStmt_002eStat"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002ePoint" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat-1"></a>
<h3 class="subsection">4.10.1 Ref.Stmt.Stat</h3>

<p>Statements have a detailed static semantics. The static semantics determine,
on a statement-by-statement basis, the <em>effects</em> the statement has on its
environment, as well the <em>legality</em> of the statement in its environment.
</p>
<p>The legality of a statement is partly governed by syntactic rules, partly by
its conformance to the types of slots it affects, and partly by a
statement-oriented static dataflow analysis. This section describes the
statement-oriented static dataflow analysis, also called the <em>typestate</em>
system.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat_002ePoint">4.10.1.1 Ref.Stmt.Stat.Point</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Inter-statement positions of logical judgements.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat_002eCFG">4.10.1.2 Ref.Stmt.Stat.CFG</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">           The control flow graph formed by statements.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat_002eConstr">4.10.1.3 Ref.Stmt.Stat.Constr</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">        Predicates applied to slots.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat_002eCond">4.10.1.4 Ref.Stmt.Stat.Cond</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Constraints required and implied by a statement.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat_002eTypestate">4.10.1.5 Ref.Stmt.Stat.Typestate</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">     Constraints that hold at points.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eStat_002eCheck">4.10.1.6 Ref.Stmt.Stat.Check</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Relating dynamic state to static typestate.
</td></tr>
</table>


<hr>
<a name="Ref_002eStmt_002eStat_002ePoint"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eCFG" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat_002ePoint-1"></a>
<h4 class="subsubsection">4.10.1.1 Ref.Stmt.Stat.Point</h4>

<p>A <em>point</em> exists before and after any statement in a Rust program.
For example, this code:
</p>
<div class="example">
<pre class="example"> s = &quot;hello, world&quot;;
 print(s);
</pre></div>

<p>Consists of two statements and four points:
</p>
<ul>
<li> the point before the first statement
</li><li> the point after the first statement
</li><li> the point before the second statement
</li><li> the point after the second statement
</li></ul>

<p>The typestate system reasons over points, rather than statements. This may
seem counter-intuitive, but points are the more primitive concept. Another way
of thinking about a point is as a set of <em>instants in time</em> at which the
state of a task is fixed. By contrast, a statement represents a <em>duration
in time</em>, during which the state of the task changes. The typestate system is
concerned with constraining the possible states of a task&rsquo;s memory at
<em>instants</em>; it is meaningless to speak of the state of a task&rsquo;s memory
&ldquo;at&rdquo; a statement, as each statement is likely to change the contents of
memory.
</p>

<hr>
<a name="Ref_002eStmt_002eStat_002eCFG"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002ePoint" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eConstr" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat_002eCFG-1"></a>
<h4 class="subsubsection">4.10.1.2 Ref.Stmt.Stat.CFG</h4>

<p>Each <em>point</em> can be considered a vertex in a directed <em>graph</em>. Each
kind of statement implies a single edge in this graph between the point before
the statement and the point after it, as well as a set of zero or more edges
from the points of the statement to points before other statements. The edges
between points represent <em>possible</em> indivisible control transfers that
might occur during execution.
</p>
<p>This implicit graph is called the <em>control flow graph</em>, or <em>CFG</em>.
</p>

<hr>
<a name="Ref_002eStmt_002eStat_002eConstr"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eCFG" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eCond" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat_002eConstr-1"></a>
<h4 class="subsubsection">4.10.1.3 Ref.Stmt.Stat.Constr</h4>

<p>A <em>predicate</em> is any pure boolean function. See section <a href="#Ref_002eItem_002eFn">Ref.Item.Fn</a>.
</p>
<p>A <em>constraint</em> is a predicate applied to specific slots.
</p>
<p>For example, consider the following code:
</p>
<div class="example">
<pre class="example">fn is_less_than(int a, int b) -&gt; bool {
     ret a &lt; b;
}

fn test() {
   let int x = 10;
   let int y = 20;
   check is_less_than(x,y);
}
</pre></div>

<p>This example defines the predicate <code>is_less_than</code>, and applies it to the
slots <code>x</code> and <code>y</code>. The constraint being checked on the third line of
the function is <code>is_less_than(x,y)</code>.
</p>
<p>Predicates can only apply to slots holding immutable values. The slots a
predicate applies to can themselves be mutable, but the types of values held
in those slots must be immutable.
</p>

<hr>
<a name="Ref_002eStmt_002eStat_002eCond"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eConstr" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eTypestate" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat_002eCond-1"></a>
<h4 class="subsubsection">4.10.1.4 Ref.Stmt.Stat.Cond</h4>

<p>A <em>condition</em> is a set of zero or more constraints.
</p>
<p>Each <em>point</em> has an associated <em>condition</em>:
</p>
<ul>
<li> The <em>precondition</em> of a statement is the condition the statement
requires in the point before the condition.
</li><li> The <em>postcondition</em> of a statement is the condition the statement
enforces in the point after the statement.
</li></ul>

<p>Any constraint present in the precondition and <em>absent</em> in the
postcondition is considered to be <em>dropped</em> by the statement.
</p>

<hr>
<a name="Ref_002eStmt_002eStat_002eTypestate"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eCond" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eCheck" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat_002eTypestate-1"></a>
<h4 class="subsubsection">4.10.1.5 Ref.Stmt.Stat.Typestate</h4>

<p>The typestate checking system <em>calculates</em> an additional
condition for each point called its typestate. For a given statement,
we call the two typestates associated with its two points the prestate
and a poststate.
</p>
<ul>
<li> The <em>prestate</em> of a statement is the typestate of the point
before the statement.
</li><li> The <em>poststate</em> of a statement is the typestate of the point
after the statement.
</li></ul>

<p>A <em>typestate</em> is a condition that has <em>been determined by the
typestate algorithm</em> to hold at a point. This is a subtle but important point
to understand: preconditions and postconditions are <em>inputs</em> to the
typestate algorithm; prestates and poststates are <em>outputs</em> from the
typestate algorithm.
</p>
<p>The typestate algorithm analyses the preconditions and postconditions of every
statement in a block, and computes a condition for each
typestate. Specifically:
</p>
<ul>
<li> Initially, every typestate is empty.
</li><li> Each statement&rsquo;s poststate is given the union of the statement&rsquo;s
prestate, precondition, and postcondition.
</li><li> Each statement&rsquo;s poststate has the difference between the statement&rsquo;s
precondition and postcondition removed.
</li><li> Each statement&rsquo;s prestate is given the intersection of the poststates
of every parent statement in the CFG.
</li><li> The previous three steps are repeated until no typestates in the
block change.
</li></ul>

<p>The typestate algorithm is a very conventional dataflow calculation, and can
be performed using bit-set operations, with one bit per predicate and one
bit-set per condition.
</p>
<p>After the typestates of a block are computed, the typestate algorithm checks
that every constraint in the precondition of a statement is satisfied by its
prestate. If any preconditions are not satisfied, the mismatch is considered a
static (compile-time) error.
</p>


<hr>
<a name="Ref_002eStmt_002eStat_002eCheck"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eTypestate" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eStat_002eCheck-1"></a>
<h4 class="subsubsection">4.10.1.6 Ref.Stmt.Stat.Check</h4>

<p>The key mechanism that connects run-time semantics and compile-time analysis
of typestates is the use of <code>check</code> statements. See section <a href="#Ref_002eStmt_002eCheck">Ref.Stmt.Check</a>. A
<code>check</code> statement guarantees that <em>if</em> control were to proceed past
it, the predicate associated with the <code>check</code> would have succeeded, so
the constraint being checked <em>statically</em> holds in subsequent
statements.<a name="DOCF10" href="#FOOT10">(10)</a>
</p>
<p>It is important to understand that the typestate system has <em>no insight</em>
into the meaning of a particular predicate. Predicates and constraints are not
evaluated in any way at compile time. Predicates are treated as specific (but
unknown) functions applied to specific (also unknown) slots. All the typestate
system does is track which of those predicates &ndash; whatever they calculate &ndash;
<em>must have been checked already</em> in order for program control to reach a
particular point in the CFG. The fundamental building block, therefore, is the
<code>check</code> statement, which tells the typestate system &ldquo;if control passes
this statement, the checked predicate holds&rdquo;.
</p>
<p>From this building block, constraints can be propagated to function signatures
and constrained types, and the responsibility to <code>check</code> a constraint
pushed further and further away from the site at which the program requires it
to hold in order to execute properly.
</p>

<hr>
<a name="Ref_002eStmt_002eDecl"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eStat_002eCheck" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl_002eItem" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eDecl-1"></a>
<h3 class="subsection">4.10.2 Ref.Stmt.Decl</h3>

<p>A <em>declaration statement</em> is one that introduces a <em>name</em> into the
enclosing statement block. The declared name may denote a new slot or a new
item. The scope of the name extends to the entire containing block, both
before and after the declaration.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eDecl_002eItem">4.10.2.1 Ref.Stmt.Decl.Item</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement declaring an item.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eDecl_002eSlot">4.10.2.2 Ref.Stmt.Decl.Slot</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">              Statement declaring a slot.
</td></tr>
</table>


<hr>
<a name="Ref_002eStmt_002eDecl_002eItem"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl_002eSlot" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eDecl_002eItem-1"></a>
<h4 class="subsubsection">4.10.2.1 Ref.Stmt.Decl.Item</h4>

<p>An <em>item declaration statement</em> has a syntactic form identical to an item
declaration within a module. Declaring an item &ndash; a function, iterator,
object, type or module &ndash; locally within a statement block is simply a way of
restricting its scope to a narrow region containing all of its uses; it is
otherwise identical in meaning to declaring the item outside the statement
block.
</p>
<p>Note: there is no implicit capture of the function&rsquo;s dynamic environment when
declaring a function-local item.
</p>

<hr>
<a name="Ref_002eStmt_002eDecl_002eSlot"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl_002eItem" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCopy" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eDecl_002eSlot-1"></a>
<h4 class="subsubsection">4.10.2.2 Ref.Stmt.Decl.Slot</h4>

<p>A <code>slot declaration statement</code> has one one of two forms:
</p>
<ul>
<li> <code>let</code> <var>mode-and-type</var> <var>slot</var> <var>optional-init</var>;
</li><li> <code>auto</code> <var>slot</var> <var>optional-init</var>;
</li></ul>

<p>Where <var>mode-and-type</var> is a slot mode and type expression, <var>slot</var> is
the name of the slot being declared, and <var>optional-init</var> is either the
empty string or an equals sign (<code>=</code>) followed by a primitive expression.
</p>
<p>Both forms introduce a new slot into the containing block scope. The new slot
is visible across the entire scope, but is initialized only at the point
following the declaration statement.
</p>
<p>The latter (<code>auto</code>) form of slot declaration causes the compiler to infer
the static type of the slot through unification with the types of values
assigned to the slot in the the remaining code in the block scope. Inferred
slots always have <em>interior</em> mode. See section <a href="#Ref_002eMem_002eSlot">Ref.Mem.Slot</a>.
</p>



<hr>
<a name="Ref_002eStmt_002eCopy"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eDecl_002eSlot" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eSpawn" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eCopy-1"></a>
<h3 class="subsection">4.10.3 Ref.Stmt.Copy</h3>

<p>A <em>copy statement</em> consists of an <em>lval</em> &ndash; a name denoting a slot &ndash;
followed by an equals-sign (<code>=</code>) and a primitive
expression. See section <a href="#Ref_002eExpr">Ref.Expr</a>.
</p>
<p>Executing a copy statement causes the value denoted by the expression &ndash;
either a value in a slot or a primitive combination of values held in slots &ndash;
to be copied into the slot denoted by the <em>lval</em>.
</p>
<p>A copy may entail the formation of references, the adjustment of reference
counts, execution of destructors, or similar adjustments in order to respect
the <code>lval</code> slot mode and any existing value held in it. All such
adjustment is automatic and implied by the <code>=</code> operator.
</p>
<p>An example of three different copy statements:
</p><div class="example">
<pre class="example">x = y;
x.y = z;
x.y = z + 2;
</pre></div>


<hr>
<a name="Ref_002eStmt_002eSpawn"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCopy" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eSend" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eSpawn-1"></a>
<h3 class="subsection">4.10.4 Ref.Stmt.Spawn</h3>

<p>A <code>spawn</code> statement consists of keyword <code>spawn</code>, followed by a
normal <em>call</em> statement (see section <a href="#Ref_002eStmt_002eCall">Ref.Stmt.Call</a>).  A <code>spawn</code>
statement causes the runtime to construct a new task executing the called
function.  The called function is referred to as the <em>entry function</em> for
the spawned task, and its arguments are copied form the spawning task to the
spawned task before the spawned task begins execution.
</p>
<p>Only arguments of interior or exterior mode are permitted in the function
called by a spawn statement, not arguments with alias mode.
</p>
<p>The result of a <code>spawn</code> statement is a <code>task</code> value.
</p>
<p>An example of a <code>spawn</code> statement:
</p><div class="example">
<pre class="example">fn helper(chan[u8] out) {
    // do some work.
    out &lt;| result;
}

let port[u8] out;
let task p = spawn helper(chan(out));
// let task run, do other things.
auto result &lt;- out;

</pre></div>


<hr>
<a name="Ref_002eStmt_002eSend"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eSpawn" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eFlush" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eSend-1"></a>
<h3 class="subsection">4.10.5 Ref.Stmt.Send</h3>

<p>Sending a value through a channel can be done via two different statements.
Both statements take an <em>lval</em>, denoting a channel, and a value to send
into the channel. The action of <em>sending</em> varies depending on the
<em>send operator</em> employed.
</p>
<p>The <em>asynchronous send</em> operator <code>&lt;+</code> adds a value to the channel&rsquo;s
queue, without blocking. If the queue is full, it is extended, taking memory
from the task&rsquo;s domain. If the task memory budget is exhausted, a signal is
sent to the task.
</p>
<p>The <em>semi-synchronous send</em> operator <code>&lt;|</code> adds a value to the
channel&rsquo;s queue <em>only if</em> the queue has room; if the queue is full, the
operation <em>blocks</em> the sender until the queue has room.
</p>
<p>An example of an asynchronous send:
</p><div class="example">
<pre class="example">chan[str] c = &hellip;;
c &lt;+ &quot;hello, world&quot;;
</pre></div>

<p>An example of a semi-synchronous send:
</p><div class="example">
<pre class="example">chan[str] c = &hellip;;
c &lt;| &quot;hello, world&quot;;
</pre></div>


<hr>
<a name="Ref_002eStmt_002eFlush"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eSend" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eRecv" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eFlush-1"></a>
<h3 class="subsection">4.10.6 Ref.Stmt.Flush</h3>

<p>A <code>flush</code> statement takes a channel and blocks the flushing task until
the channel&rsquo;s queue has emptied. It can be used to implement a more precise
form of flow-control than with the send operators alone.
</p>
<p>An example of the <code>flush</code> statement:
</p><div class="example">
<pre class="example">chan[str] c = &hellip;;
c &lt;| &quot;hello, world&quot;;
flush c;
</pre></div>



<hr>
<a name="Ref_002eStmt_002eRecv"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eFlush" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCall" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eRecv-1"></a>
<h3 class="subsection">4.10.7 Ref.Stmt.Recv</h3>

<p>The <em>receive statement</em> takes an <var>lval</var> to receive into and an
expression denoting a port, and applies the <em>receive operator</em>
(<code>&lt;-</code>) to the pair, copying a value out of the port and into the
<var>lval</var>. The statement causes the receiving task to enter the <em>blocked
reading</em> state until a task is sending a value to the port, at which point the
runtime pseudo-randomly selects a sending task and copies a value from the
head of one of the task queues to the receiving slot, and un-blocks the
receiving task. See section <a href="#Ref_002eRun_002eComm">Ref.Run.Comm</a>.
</p>
<p>An example of a <em>receive</em>:
</p><div class="example">
<pre class="example">port[str] p = &hellip;;
let str s &lt;- p;
</pre></div>


<hr>
<a name="Ref_002eStmt_002eCall"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eRecv" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eBind" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eCall-1"></a>
<h3 class="subsection">4.10.8 Ref.Stmt.Call</h3>

<p>A <em>call statement</em> invokes a function, providing a tuple of input slots
and a reference to an output slot. If the function eventually returns, then
the statement completes.
</p>
<p>A call statement statically requires that the precondition declared in the
callee&rsquo;s signature is satisfied by the statement prestate. In this way,
typestates propagate through function boundaries. See section <a href="#Ref_002eStmt_002eStat">Ref.Stmt.Stat</a>.
</p>
<p>An example of a call statement:
</p><div class="example">
<pre class="example">let int x = add(1, 2);
</pre></div>


<hr>
<a name="Ref_002eStmt_002eBind"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCall" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eRet" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eBind-1"></a>
<h3 class="subsection">4.10.9 Ref.Stmt.Bind</h3>

<p>A <em>bind statement</em> constructs a new function from an existing
function.<a name="DOCF11" href="#FOOT11">(11)</a> The new function has zero or more of its
arguments <em>bound</em> into a new, hidden exterior tuple that holds the
bindings. For each concrete argument passed in the <code>bind</code> statement, the
corresponding parameter in the existing function is <em>omitted</em> as a
parameter of the new function. For each argument passed the placeholder symbol
<code>_</code> in the <code>bind</code> statement, the corresponding parameter of the
existing function is <em>retained</em> as a parameter of the new function.
</p>
<p>Any subsequent invocation of the new function with residual arguments causes
invocation of the existing function with the combination of bound arguments
and residual arguments that was specified during the binding.
</p>
<p>An example of a <code>bind</code> statement:
</p><div class="example">
<pre class="example">fn add(int x, int y) -&gt; int {
    ret x + y;
}
type single_param_fn = fn(int) -&gt; int;

let single_param_fn add4 = bind add(4, _);

let single_param_fn add5 = bind add(_, 5);

check (add(4,5) == add4(5));
check (add(4,5) == add5(4));

</pre></div>

<p>A <code>bind</code> statement generally stores a copy of the bound arguments in the
hidden exterior tuple. For bound interior slots and alias slots in the bound
function signature, an interior slot is allocated in the hidden tuple and
populated with a copy of the bound value. For bound exterior slots in the
bound function signature, an exterior slot is allocated in the hidden tuple
and populated with a copy of the bound value, an exterior (pointer) value.
</p>
<p>The <code>bind</code> statement is a lightweight mechanism for simulating the more
elaborate construct of <em>lexical closures</em> that exist in other
languages. Rust has no support for lexical closures, but many realistic uses
of them can be achieved with <code>bind</code> statements.
</p>


<hr>
<a name="Ref_002eStmt_002eRet"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eBind" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eBe" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eRet-1"></a>
<h3 class="subsection">4.10.10 Ref.Stmt.Ret</h3>

<p>Executing a <code>ret</code> statement<a name="DOCF12" href="#FOOT12">(12)</a>  copies a
value into the return slot of the current function, destroys the
current function activation frame, and transfers control to the caller
frame.
</p>
<p>An example of a <code>ret</code> statement:
</p><div class="example">
<pre class="example">fn max(int a, int b) -&gt; int {
   if (a &gt; b) {
      ret a;
   }
   ret b;
}
</pre></div>


<hr>
<a name="Ref_002eStmt_002eBe"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eRet" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002ePut" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eBe-1"></a>
<h3 class="subsection">4.10.11 Ref.Stmt.Be</h3>

<p>Executing a <code>be</code> statement <a name="DOCF13" href="#FOOT13">(13)</a>  destroys the
current function activation frame and replaces it with an activation frame for
the called function. In other words, <code>be</code> executes a tail-call. The
syntactic form of a <code>be</code> statement is therefore limited to <em>tail
position</em>: its argument must be a <em>call expression</em>, and it must be the
last statement in a block.
</p>
<p>An example of a <code>be</code> statement:
</p><div class="example">
<pre class="example">fn print_loop(int n) {
  if (n &lt;= 0) {
    ret;
  } else {
    print_int(n);
    be print_loop(n-1);
  }
}
</pre></div>

<p>The above example executes in constant space, replacing each frame with a new
copy of itself.
</p>



<hr>
<a name="Ref_002eStmt_002ePut"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eBe" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eFail" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002ePut-1"></a>
<h3 class="subsection">4.10.12 Ref.Stmt.Put</h3>

<p>Executing a <code>put</code> statement copies a value into the put slot of the
current iterator, suspends execution of the current iterator, and transfers
control to the current put-recipient frame.
</p>
<p>A <code>put</code> statement is only valid within an iterator.  <a name="DOCF14" href="#FOOT14">(14)</a> The
current put-recipient will eventually resume the suspended iterator containing
the <code>put</code> statement, either continuing execution after the <code>put</code>
statement, or terminating its execution and destroying the iterator frame.
</p>


<hr>
<a name="Ref_002eStmt_002eFail"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002ePut" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eLog" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eFail-1"></a>
<h3 class="subsection">4.10.13 Ref.Stmt.Fail</h3>

<p>Executing a <code>fail</code> statement causes a task to enter the <em>failing</em>
state. In the <em>failing</em> state, a task unwinds its stack, destroying all
frames and freeing all resources until it reaches its entry frame, at which
point it halts execution in the <em>dead</em> state.
</p>

<hr>
<a name="Ref_002eStmt_002eLog"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eFail" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eNote" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eLog-1"></a>
<h3 class="subsection">4.10.14 Ref.Stmt.Log</h3>

<p>Executing a <code>log</code> statement may, depending on runtime configuration,
cause a value to be appended to an internal diagnostic logging buffer provided
by the runtime or emitted to a system console. Log statements are enabled or
disabled dynamically at run-time on a per-task and per-item
basis. See section <a href="#Ref_002eRun_002eLog">Ref.Run.Log</a>.
</p>
<p>Executing a <code>log</code> statement not considered an <code>io</code> effect in the
effect system. In other words, a pure function remains pure even if it
contains a log statement.
</p>


<hr>
<a name="Ref_002eStmt_002eNote"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eLog" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eWhile" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eNote-1"></a>
<h3 class="subsection">4.10.15 Ref.Stmt.Note</h3>

<p>A <code>note</code> statement has no effect during normal execution. The purpose of
a <code>note</code> statement is to provide additional diagnostic information to the
logging subsystem during task failure. See section <a href="#Ref_002eStmt_002eLog">Ref.Stmt.Log</a>. Using <code>note</code>
statements, normal diagnostic logging can be kept relatively sparse, while
still providing verbose diagnostic &ldquo;back-traces&rdquo; when a task fails.
</p>
<p>When a task is failing, control frames <em>unwind</em> from the innermost frame
to the outermost, and from the innermost lexical block within an unwinding
frame to the outermost. When unwinding a lexical block, the runtime processes
all the <code>note</code> statements in the block sequentially, from the first
statement of the block to the last.  During processing, a <code>note</code>
statement has equivalent meaning to a <code>log</code> statement: it causes the
runtime to append the argument of the <code>note</code> to the internal logging
diagnostic buffer.
</p>
<p>An example of a <code>note</code> statement:
</p><div class="example">
<pre class="example">fn read_file_lines(&amp;str path) -&gt; vec[str] {
    note path;
    vec[str] r;
    file f = open_read(path);
    for* (str &amp;s = lines(f)) {
        vec.append(r,s);
    }
    ret r;
}
</pre></div>

<p>In this example, if the task fails while attempting to open or read a file,
the runtime will log the path name that was being read. If the function
completes normally, the runtime will not log the path.
</p>
<p>A slot that is marked by a <code>note</code> statement does <em>not</em> have its
value copied aside when control passes through the <code>note</code>. In other
words, if a <code>note</code> statement notes a particular slot, and code after the
<code>note</code> that slot, and then a subsequent failure occurs, the
<em>mutated</em> value will be logged during unwinding, <em>not</em> the original
value that was held in the slot at the moment control passed through the
<code>note</code> statement.
</p>

<hr>
<a name="Ref_002eStmt_002eWhile"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eNote" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eBreak" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eWhile-1"></a>
<h3 class="subsection">4.10.16 Ref.Stmt.While</h3>

<p>A <code>while</code> statement is a loop construct. A <code>while</code> loop may be
either a simple <code>while</code> or a <code>do</code>-<code>while</code> loop.
</p>
<p>In the case of a simple <code>while</code>, the loop begins by evaluating the
boolean loop conditional expression. If the loop conditional expression
evaluates to <code>true</code>, the loop body block executes and control returns to
the loop conditional expression. If the loop conditional expression evaluates
to <code>false</code>, the <code>while</code> statement completes.
</p>
<p>In the case of a <code>do</code>-<code>while</code>, the loop begins with an execution of
the loop body. After the loop body executes, it evaluates the loop conditional
expression. If it evaluates to <code>true</code>, control returns to the beginning
of the loop body. If it evaluates to <code>false</code>, control exits the loop.
</p>
<p>An example of a simple <code>while</code> statement:
</p><div class="example">
<pre class="example">while (i &lt; 10) {
    print(&quot;hello\n&quot;);
    i = i + 1;
}
</pre></div>

<p>An example of a <code>do</code>-<code>while</code> statement:
</p><div class="example">
<pre class="example">do {
    print(&quot;hello\n&quot;);
    i = i + 1;
} while (i &lt; 10);
</pre></div>


<hr>
<a name="Ref_002eStmt_002eBreak"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eWhile" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCont" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eBreak-1"></a>
<h3 class="subsection">4.10.17 Ref.Stmt.Break</h3>

<p>Executing a <code>break</code> statement immediately terminates the innermost loop
enclosing it. It is only permitted in the body of a loop.
</p>

<hr>
<a name="Ref_002eStmt_002eCont"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eBreak" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eFor" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eCont-1"></a>
<h3 class="subsection">4.10.18 Ref.Stmt.Cont</h3>

<p>Executing a <code>cont</code> statement immediately terminates the current iteration
of the innermost loop enclosing it, returning control to the loop
<em>head</em>. In the case of a <code>while</code> loop, the head is the conditional
expression controlling the loop. In the case of a <code>for</code> or <code>for
each</code> loop, the head is the iterator or vector-slice increment controlling the
loop.
</p>
<p>A <code>cont</code> statement is only permitted in the body of a loop.
</p>


<hr>
<a name="Ref_002eStmt_002eFor"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCont" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eForeach" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eFor-1"></a>
<h3 class="subsection">4.10.19 Ref.Stmt.For</h3>

<p>A <em>for loop</em> is controlled by a vector or string. The for loop
bounds-checks the underlying sequence <em>once</em> when initiating the loop,
then repeatedly copies each value of the underlying sequence into the element
variable, executing the loop body once per copy. To perform a for loop on a
sub-range of a vector or string, form a temporary slice over the sub-range and
run the loop over the slice.
</p>
<p>Example of a 4 for loops, all identical:
</p><div class="example">
<pre class="example">let vec[foo] v = vec(a, b, c);

for (&amp;foo e in v.(0, _vec.len(v))) {
    bar(e);
}

for (&amp;foo e in v.(0,)) {
    bar(e);
}

for (&amp;foo e in v.(,)) {
    bar(e);
}

for (&amp;foo e in v) {
    bar(e);
}
</pre></div>


<hr>
<a name="Ref_002eStmt_002eForeach"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eFor" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eIf" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eForeach-1"></a>
<h3 class="subsection">4.10.20 Ref.Stmt.Foreach</h3>

<p>An <em>foreach loop</em> is denoted by the <code>for each</code> keywords, and is
controlled by an iterator. The loop executes once for each value <code>put</code> by
the iterator.  When the iterator returns or fails, the loop terminates.
</p>
<p>Example of a foreach loop:
</p><div class="example">
<pre class="example">let str txt;
let vec[str] lines;
for each (&amp;str s = _str.split(txt, &quot;\n&quot;)) {
    vec.push(lines, s);
}
</pre></div>



<hr>
<a name="Ref_002eStmt_002eIf"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eForeach" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eIf-1"></a>
<h3 class="subsection">4.10.21 Ref.Stmt.If</h3>

<p>An <code>if</code> statement is a conditional branch in program control. The form of
an <code>if</code> statement is a parenthesized condition expression, followed by a
consequent block, and an optional trailing <code>else</code> block. The condition
expression must have type <code>bool</code>. If the condition expression evaluates
to <code>true</code>, the consequent block is executed and any <code>else</code> block is
skipped. If the condition expression evaluates to <code>false</code>, the consequent
block is skipped and any <code>else</code> block is executed.
</p>

<hr>
<a name="Ref_002eStmt_002eAlt"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eIf" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt_002eComm" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eAlt-1"></a>
<h3 class="subsection">4.10.22 Ref.Stmt.Alt</h3>

<p>An <code>alt</code> statement is a multi-directional branch in program control.
There are three kinds of <code>alt</code> statement: communication <code>alt</code>
statements, pattern <code>alt</code> statements, and <code>alt type</code> statements.
</p>
<p>The form of each kind of <code>alt</code> is similar: an initial <em>head</em> that
describes the criteria for branching, followed by a sequence of zero or more
<em>arms</em>, each of which describes a <em>case</em> and provides a <em>block</em>
of statements associated with the case. When an <code>alt</code> is executed,
control enters the head, determines which of the cases to branch to, branches
to the block associated with the chosen case, and then proceeds to the
statement following the <code>alt</code> when the case block completes.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eAlt_002eComm">4.10.22.1 Ref.Stmt.Alt.Comm</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Statement for branching on communication events.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eAlt_002ePat">4.10.22.2 Ref.Stmt.Alt.Pat</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">          Statement for branching on pattern matches.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eStmt_002eAlt_002eType">4.10.22.3 Ref.Stmt.Alt.Type</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">         Statement for branching on types.
</td></tr>
</table>


<hr>
<a name="Ref_002eStmt_002eAlt_002eComm"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt_002ePat" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eAlt_002eComm-1"></a>
<h4 class="subsubsection">4.10.22.1 Ref.Stmt.Alt.Comm</h4>

<p>The simplest form of <code>alt</code> statement is the a <em>communication</em>
<code>alt</code>. The cases of a communication <code>alt</code>&rsquo;s arms are send, receive
and flush statements. See section <a href="#Ref_002eTask_002eComm">Ref.Task.Comm</a>.
</p>
<p>To execute a communication <code>alt</code>, the runtime checks all of the ports and
channels involved in the arms of the statement to see if any <code>case</code> can
execute without blocking.  If no <code>case</code> can execute, the task blocks, and
the runtime unblocks the task when a <code>case</code> <em>can</em> execute. The
runtime then makes a pseudo-random choice from among the set of <code>case</code>
statements that can execute, executes the statement of the <code>case</code> and
branches to the block of that arm.
</p>
<p>An example of a communication <code>alt</code> statement:
</p><div class="example">
<pre class="example">let chan c[int] = foo();
let port p[str] = bar();
let int x = 0;
let vec[str] strs;

alt {
    case (str s &lt;- p) {
        vec.append(strs, s);
    }
    case (c &lt;| x) {
        x++;
    }
}
</pre></div>


<hr>
<a name="Ref_002eStmt_002eAlt_002ePat"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt_002eComm" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt_002eType" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eAlt_002ePat-1"></a>
<h4 class="subsubsection">4.10.22.2 Ref.Stmt.Alt.Pat</h4>

<p>A pattern <code>alt</code> statement branches on a <em>pattern</em>. The exact form of
matching that occurs depends on the pattern. Patterns consist of some
combination of literals, tag constructors, variable binding specifications and
placeholders (<code>_</code>). A pattern <code>alt</code> has a parenthesized <em>head
expression</em>, which is the value to compare to the patterns. The type of the
patterns must equal the type of the head expression.
</p>
<p>To execute a pattern <code>alt</code> statement, first the head expression is
evaluated, then its value is sequentially compared to the patterns in the arms
until a match is found. The first arm with a matching <code>case</code> pattern is
chosen as the branch target of the <code>alt</code>, any variables bound by the
pattern are assigned to local <em>auto</em> slots in the arm&rsquo;s block, and
control enters the block.
</p>
<p>An example of a pattern <code>alt</code> statement:
</p>
<div class="example">
<pre class="example">type list[X] = tag(nil, cons(X, @list[X]));

let list[int] x = cons(10, cons(11, nil));

alt (x) {
    case (cons(a, cons(b, _))) {
        process_pair(a,b);
    }
    case (cons(v=10, _)) {
        process_ten(v);
    }
    case (_) {
        fail;
    }
}
</pre></div>



<hr>
<a name="Ref_002eStmt_002eAlt_002eType"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt_002ePat" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eProve" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eAlt_002eType-1"></a>
<h4 class="subsubsection">4.10.22.3 Ref.Stmt.Alt.Type</h4>

<p>An <code>alt type</code> statement is similar to a pattern <code>alt</code>, but branches
on the <em>type</em> of its head expression, rather than the value. The head
expression of an <code>alt type</code> statement must be of type <code>any</code>, and the
arms of the statement are slot patterns rather than value patterns. Control
branches to the arm with a <code>case</code> that matches the <em>actual type</em> of
the value in the <code>any</code>.
</p>
<p>An example of an <code>alt type</code> statement:
</p>
<div class="example">
<pre class="example">let any x = foo();

alt type (x) {
    case (int i) {
        ret i;
    }
    case (list[int] li) {
        ret int_list_sum(li);
    }
    case (list[X] lx) {
        ret list_len(lx);
    }
    case (_) {
        ret 0;
    }
}
</pre></div>



<hr>
<a name="Ref_002eStmt_002eProve"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eAlt_002eType" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCheck" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eProve-1"></a>
<h3 class="subsection">4.10.23 Ref.Stmt.Prove</h3>

<p>A <code>prove</code> statement has no run-time effect. Its purpose is to statically
check (and document) that its argument constraint holds at its statement entry
point. If its argument typestate does not hold, under the typestate algorithm,
the program containing it will fail to compile.
</p>

<hr>
<a name="Ref_002eStmt_002eCheck"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eProve" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eIfCheck" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eCheck-1"></a>
<h3 class="subsection">4.10.24 Ref.Stmt.Check</h3>

<p>A <code>check</code> statement connects dynamic assertions made at run-time to the
static typestate system. A <code>check</code> statement takes a constraint to check
at run-time. If the constraint holds at run-time, control passes through the
<code>check</code> and on to the next statement in the enclosing block. If the
condition fails to hold at run-time, the <code>check</code> statement behaves as a
<code>fail</code> statement.
</p>
<p>The typestate algorithm is built around <code>check</code> statements, and in
particular the fact that control <em>will not pass</em> a check statement with a
condition that fails to hold. The typestate algorithm can therefore assume
that the (static) postcondition of a <code>check</code> statement includes the
checked constraint itself. From there, the typestate algorithm can perform
dataflow calculations on subsequent statements, propagating conditions forward
and statically comparing implied states and their
specifications. See section <a href="#Ref_002eStmt_002eStat">Ref.Stmt.Stat</a>.
</p>
<div class="example">
<pre class="example">fn even(&amp;int x) -&gt; bool {
    ret x &amp; 1 == 0;
}

fn print_even(int x) : even(x) {
    print(x);
}

fn test() {
    let int y = 8;

    // Cannot call print_even(y) here.

    check even(y);

    // Can call print_even(y) here, since even(y) now holds.
    print_even(y);
}
</pre></div>


<hr>
<a name="Ref_002eStmt_002eIfCheck"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eCheck" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eStmt_002eIfCheck-1"></a>
<h3 class="subsection">4.10.25 Ref.Stmt.IfCheck</h3>

<p>An <code>if check</code> statement combines a <code>if</code> statement and a <code>check</code>
statement in an indivisible unit that can be used to build more complex
conditional control flow than the <code>check</code> statement affords.
</p>
<p>In fact, <code>if check</code> is a &ldquo;more primitive&rdquo; statement <code>check</code>;
instances of the latter can be rewritten as instances of the former. The
following two examples are equivalent:
</p>
<br>
<p>Example using <code>check</code>:
</p><div class="example">
<pre class="example">check even(x);
print_even(x);
</pre></div>

<br>
<p>Equivalent example using <code>if check</code>:
</p><div class="example">
<pre class="example">if check even(x) {
    print_even(x);
} else {
    fail;
}
</pre></div>


<hr>
<a name="Ref_002eRun"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eStmt_002eIfCheck" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Reference" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eMem" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun-1"></a>
<h2 class="section">4.11 Ref.Run</h2>

<p>The Rust <em>runtime</em> is a relatively compact collection of C and Rust code
that provides fundamental services and datatypes to all Rust tasks at
run-time. It is smaller and simpler than many modern language runtimes. It is
tightly integrated into the language&rsquo;s execution model of slots, tasks,
communication, reflection, logging and signal handling.
</p>
<table class="menu" border="0" cellspacing="0">
<tr><td align="left" valign="top"><a href="#Ref_002eRun_002eMem">4.11.1 Ref.Run.Mem</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Runtime memory management service.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eRun_002eType">4.11.2 Ref.Run.Type</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Runtime built-in type services.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eRun_002eComm">4.11.3 Ref.Run.Comm</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Runtime communication service.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eRun_002eRefl">4.11.4 Ref.Run.Refl</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                Runtime reflection system.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eRun_002eLog">4.11.5 Ref.Run.Log</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Runtime logging system.
</td></tr>
<tr><td align="left" valign="top"><a href="#Ref_002eRun_002eSig">4.11.6 Ref.Run.Sig</a></td><td>&nbsp;&nbsp;</td><td align="left" valign="top">                 Runtime signal handler.
</td></tr>
</table>


<hr>
<a name="Ref_002eRun_002eMem"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eType" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun_002eMem-1"></a>
<h3 class="subsection">4.11.1 Ref.Run.Mem</h3>

<p>The runtime memory-management system is based on a <em>service-provider
interface</em>, through which the runtime requests blocks of memory from its
environment and releases them back to its environment when they are no longer
in use. The default implementation of the service-provider interface consists
of the C runtime functions <code>malloc</code> and <code>free</code>.
</p>
<p>The runtime memory-management system in turn supplies Rust tasks with
facilities for allocating, extending and releasing stacks, as well as
allocating and freeing exterior values.
</p>

<hr>
<a name="Ref_002eRun_002eType"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eMem" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eComm" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun_002eType-1"></a>
<h3 class="subsection">4.11.2 Ref.Run.Type</h3>

<p>The runtime provides C and Rust code to manage several built-in types:
</p><ul>
<li> <code>vec</code>, the type of vectors.
</li><li> <code>str</code>, the type of UTF-8 strings.
</li><li> <code>big</code>, the type of arbitrary-precision integers.
</li><li> <code>chan</code>, the type of communication channels.
</li><li> <code>port</code>, the type of communication ports.
</li><li> <code>task</code>, the type of tasks.
</li></ul>
<p>Support for other built-in types such as simple types, tuples,
records, and tags is open-coded by the Rust compiler.
</p>

<hr>
<a name="Ref_002eRun_002eComm"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eType" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eRefl" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun_002eComm-1"></a>
<h3 class="subsection">4.11.3 Ref.Run.Comm</h3>

<p>The runtime provides code to manage inter-task communication.  This includes
the system of task-lifecycle state transitions depending on the contents of
queues, as well as code to copy values between queues and their recipients and
to serialize values for transmission over operating-system inter-process
communication facilities.
</p>

<hr>
<a name="Ref_002eRun_002eRefl"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eComm" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eLog" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun_002eRefl-1"></a>
<h3 class="subsection">4.11.4 Ref.Run.Refl</h3>

<p>The runtime reflection system is driven by the DWARF tables emitted into a
crate at compile-time. Reflecting on a slot or item allocates a Rust data
structure corresponding to the DWARF DIE for that slot or item.
</p>

<hr>
<a name="Ref_002eRun_002eLog"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eRefl" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eSig" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun_002eLog-1"></a>
<h3 class="subsection">4.11.5 Ref.Run.Log</h3>

<p>The runtime contains a system for directing logging statements to a logging
console and/or internal logging buffers. See section <a href="#Ref_002eStmt_002eLog">Ref.Stmt.Log</a>.  Logging
statements can be enabled or disabled via a two-dimensional filtering process:
</p>
<ul>
<li>
<br>
</li><li>
By Item

<p>Each <em>item</em> (module, function, iterator, object, type) in Rust has a
static name-path within its crate module, and can have logging enabled or
disabled on a name-path-prefix basis.
</p>
<br>
</li><li>
By Task

<p>Each <em>task</em> in a running Rust program has a unique ownership-path through
the task ownership tree, and can have logging enabled or disabled on an
ownership-path-prefix basis.
</p></li></ul>

<p>Logging is integrated into the language for efficiency reasons, as well as the
need to filter logs based on these two built-in dimensions.
</p>

<hr>
<a name="Ref_002eRun_002eSig"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eLog" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next section in reading order"> &gt; </a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Next chapter"> &gt;&gt; </a>]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Ref_002eRun_002eSig-1"></a>
<h3 class="subsection">4.11.6 Ref.Run.Sig</h3>

<p>The runtime signal-handling system is driven by a signal-dispatch table and a
signal queue associated with each task. Sending a signal to a task inserts the
signal into the task&rsquo;s signal queue and marks the task as having a pending
signal. At the next scheduling opportunity, the runtime processes signals in
the task&rsquo;s queue using its dispatch table. The signal queue memory is charged
to the task&rsquo;s domain; if the queue grows too big, the task will fail.
</p>


<hr>
<a name="Index"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Reference" title="Beginning of this chapter or previous chapter"> &lt;&lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Ref_002eRun_002eSig" title="Previous section in reading order"> &lt; </a>]</td>
<td valign="middle" align="left">[<a href="#Top" title="Up section"> Up </a>]</td>
<td valign="middle" align="left">[ &gt; ]</td>
<td valign="middle" align="left">[ &gt;&gt; ]</td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left"> &nbsp; </td>
<td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<a name="Index-1"></a>
<h1 class="chapter">5 Index</h1>


<hr size="6">
<a name="SEC_Foot"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Footnotes</h1>

<h3><a name="FOOT1" href="#DOCF1">(1)</a></h3>
<p>A crate is somewhat analogous to an
<em>assembly</em> in the ECMA-335 CLI model, a <em>library</em> in the SML/NJ
Compilation Manager, a <em>unit</em> in the Owens and Flatt module system, or a
<em>configuration</em> in Mesa.
</p><h3><a name="FOOT2" href="#DOCF2">(2)</a></h3>
<p>The syntax-extension system is analogous to the extensible
reader system provided by Lisp <em>readtables</em>, or the Camlp4 system of
Objective Caml.
</p><h3><a name="FOOT3" href="#DOCF3">(3)</a></h3>
<p>It may help to remember nautical terminology
when differentiating channels from ports.  Many different waterways &ndash;
channels &ndash; may lead to the same port.
</p><h3><a name="FOOT4" href="#DOCF4">(4)</a></h3>
<p>A Rust <code>uint</code> is analogous to a C99
<code>uintptr_t</code>.
</p><h3><a name="FOOT5" href="#DOCF5">(5)</a></h3>
<p>A Rust <code>int</code> is analogous to a C99
<code>intptr_t</code>.
</p><h3><a name="FOOT6" href="#DOCF6">(6)</a></h3>
<p>The &ldquo;nil&rdquo; value <code>()</code> is <em>not</em> a sentinel
&ldquo;null pointer&rdquo; value for alias or exterior slots; the &ldquo;nil&rdquo; type is the
implicit return type from functions otherwise lacking a return type, and can
be used in other contexts (such as message-sending or type-parametric code) as
a zero-byte type.
</p><h3><a name="FOOT7" href="#DOCF7">(7)</a></h3>
<p>A Rust <code>big</code> is analogous to a Lisp
bignum or a Python long integer.
</p><h3><a name="FOOT8" href="#DOCF8">(8)</a></h3>
<p>The <code>rec</code> type-constructor is analogous to the
<code>struct</code> type-constructor in the Algol/C family, the <em>record</em> types
of the ML family, or the <em>structure</em> types of the Lisp family.
</p><h3><a name="FOOT9" href="#DOCF9">(9)</a></h3>
<p>The <code>tag</code> type is analogous to a <code>data</code> constructor
declaration in ML or a <em>pick ADT</em> in Limbo.
</p><h3><a name="FOOT10" href="#DOCF10">(10)</a></h3>
<p>A <code>check</code> statement is similar to an <code>assert</code>
call in a C program, with the significant difference that the Rust compiler
<em>tracks</em> the constraint that each <code>check</code> statement
enforces. Naturally, <code>check</code> statements cannot be omitted from a
&ldquo;production build&rdquo; of a Rust program the same way <code>asserts</code> are
frequently disabled in deployed C programs.
</p><h3><a name="FOOT11" href="#DOCF11">(11)</a></h3>
<p>The <code>bind</code> statement is analogous to the <code>bind</code>
expression in the Sather language.
</p><h3><a name="FOOT12" href="#DOCF12">(12)</a></h3>
<p>A <code>ret</code> statement is
analogous to a <code>return</code> statement in the C family.
</p><h3><a name="FOOT13" href="#DOCF13">(13)</a></h3>
<p>A <code>be</code> statement in is
analogous to a <code>become</code> statement in Newsqueak or Alef.
</p><h3><a name="FOOT14" href="#DOCF14">(14)</a></h3>
<p>A
<code>put</code> statement is analogous to a <code>yield</code> statement in the CLU,
Sather and Objective C 2.0 languages, or in more recent languages providing a
&ldquo;generator&rdquo; facility, such as Python, Javascript or C#. Like the generators
of CLU, Sather and Objective C 2.0, but <em>unlike</em> these later languages,
Rust&rsquo;s iterators reside on the stack and obey a strict stack discipline.
</p><hr>
<a name="SEC_Contents"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>Table of Contents</h1>

<div class="contents">

<ul class="no-bullet">
  <li><a name="toc-Disclaimer-1" href="#Disclaimer">1 Disclaimer</a></li>
  <li><a name="toc-Introduction-1" href="#Introduction">2 Introduction</a>
  <ul class="no-bullet">
    <li><a name="toc-Goals-1" href="#Goals">2.1 Goals</a></li>
    <li><a name="toc-Sales-Pitch-1" href="#Sales-Pitch">2.2 Sales Pitch</a></li>
    <li><a name="toc-Influences-1" href="#Influences">2.3 Influences</a></li>
  </ul></li>
  <li><a name="toc-Tutorial-1" href="#Tutorial">3 Tutorial</a></li>
  <li><a name="toc-Reference-1" href="#Reference">4 Reference</a>
  <ul class="no-bullet">
    <li><a name="toc-Ref_002eLex-1" href="#Ref_002eLex">4.1 Ref.Lex</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eLex_002eIgnore-1" href="#Ref_002eLex_002eIgnore">4.1.1 Ref.Lex.Ignore</a></li>
      <li><a name="toc-Ref_002eLex_002eIdent-1" href="#Ref_002eLex_002eIdent">4.1.2 Ref.Lex.Ident</a></li>
      <li><a name="toc-Ref_002eLex_002eKey-1" href="#Ref_002eLex_002eKey">4.1.3 Ref.Lex.Key</a></li>
      <li><a name="toc-Ref_002eLex_002eNum-1" href="#Ref_002eLex_002eNum">4.1.4 Ref.Lex.Num</a></li>
      <li><a name="toc-Ref_002eLex_002eText-1" href="#Ref_002eLex_002eText">4.1.5 Ref.Lex.Text</a></li>
      <li><a name="toc-Ref_002eLex_002eSyntax-1" href="#Ref_002eLex_002eSyntax">4.1.6 Ref.Lex.Syntax</a></li>
      <li><a name="toc-Ref_002eLex_002eSym-1" href="#Ref_002eLex_002eSym">4.1.7 Ref.Lex.Sym</a></li>
    </ul></li>
    <li><a name="toc-Ref_002ePath-1" href="#Ref_002ePath">4.2 Ref.Path</a></li>
    <li><a name="toc-Ref_002eGram-1" href="#Ref_002eGram">4.3 Ref.Gram</a></li>
    <li><a name="toc-Ref_002eComp-1" href="#Ref_002eComp">4.4 Ref.Comp</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eComp_002eCrate-1" href="#Ref_002eComp_002eCrate">4.4.1 Ref.Comp.Crate</a></li>
      <li><a name="toc-Ref_002eComp_002eMeta-1" href="#Ref_002eComp_002eMeta">4.4.2 Ref.Comp.Meta</a></li>
      <li><a name="toc-Ref_002eComp_002eSyntax-1" href="#Ref_002eComp_002eSyntax">4.4.3 Ref.Comp.Syntax</a></li>
    </ul></li>
    <li><a name="toc-Ref_002eMem-1" href="#Ref_002eMem">4.5 Ref.Mem</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eMem_002eAlloc-1" href="#Ref_002eMem_002eAlloc">4.5.1 Ref.Mem.Alloc</a></li>
      <li><a name="toc-Ref_002eMem_002eOwn-1" href="#Ref_002eMem_002eOwn">4.5.2 Ref.Mem.Own</a></li>
      <li><a name="toc-Ref_002eMem_002eSlot-1" href="#Ref_002eMem_002eSlot">4.5.3 Ref.Mem.Slot</a></li>
      <li><a name="toc-Ref_002eMem_002eInit-1" href="#Ref_002eMem_002eInit">4.5.4 Ref.Mem.Init</a></li>
      <li><a name="toc-Ref_002eMem_002eAcct-1" href="#Ref_002eMem_002eAcct">4.5.5 Ref.Mem.Acct</a></li>
    </ul></li>
    <li><a name="toc-Ref_002eTask-1" href="#Ref_002eTask">4.6 Ref.Task</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eTask_002eComm-1" href="#Ref_002eTask_002eComm">4.6.1 Ref.Task.Comm</a></li>
      <li><a name="toc-Ref_002eTask_002eLife-1" href="#Ref_002eTask_002eLife">4.6.2 Ref.Task.Life</a></li>
      <li><a name="toc-Ref_002eTask_002eDom-1" href="#Ref_002eTask_002eDom">4.6.3 Ref.Task.Dom</a></li>
      <li><a name="toc-Ref_002eTask_002eSched-1" href="#Ref_002eTask_002eSched">4.6.4 Ref.Task.Sched</a></li>
    </ul></li>
    <li><a name="toc-Ref_002eItem-1" href="#Ref_002eItem">4.7 Ref.Item</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eItem_002eMod-1" href="#Ref_002eItem_002eMod">4.7.1 Ref.Item.Mod</a>
      <ul class="no-bullet">
        <li><a name="toc-Ref_002eItem_002eMod_002eImport-1" href="#Ref_002eItem_002eMod_002eImport">4.7.1.1 Ref.Item.Mod.Import</a></li>
        <li><a name="toc-Ref_002eItem_002eMod_002eExport-1" href="#Ref_002eItem_002eMod_002eExport">4.7.1.2 Ref.Item.Mod.Export</a></li>
      </ul></li>
      <li><a name="toc-Ref_002eItem_002eFn-1" href="#Ref_002eItem_002eFn">4.7.2 Ref.Item.Fn</a></li>
      <li><a name="toc-Ref_002eItem_002eIter-1" href="#Ref_002eItem_002eIter">4.7.3 Ref.Item.Iter</a></li>
      <li><a name="toc-Ref_002eItem_002eObj-1" href="#Ref_002eItem_002eObj">4.7.4 Ref.Item.Obj</a></li>
      <li><a name="toc-Ref_002eItem_002eType-1" href="#Ref_002eItem_002eType">4.7.5 Ref.Item.Type</a></li>
    </ul></li>
    <li><a name="toc-Ref_002eType-1" href="#Ref_002eType">4.8 Ref.Type</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eType_002eAny-1" href="#Ref_002eType_002eAny">4.8.1 Ref.Type.Any</a></li>
      <li><a name="toc-Ref_002eType_002eMach-1" href="#Ref_002eType_002eMach">4.8.2 Ref.Type.Mach</a></li>
      <li><a name="toc-Ref_002eType_002eInt-1" href="#Ref_002eType_002eInt">4.8.3 Ref.Type.Int</a></li>
      <li><a name="toc-Ref_002eType_002ePrim-1" href="#Ref_002eType_002ePrim">4.8.4 Ref.Type.Prim</a></li>
      <li><a name="toc-Ref_002eType_002eBig-1" href="#Ref_002eType_002eBig">4.8.5 Ref.Type.Big</a></li>
      <li><a name="toc-Ref_002eType_002eText-1" href="#Ref_002eType_002eText">4.8.6 Ref.Type.Text</a></li>
      <li><a name="toc-Ref_002eType_002eRec-1" href="#Ref_002eType_002eRec">4.8.7 Ref.Type.Rec</a></li>
      <li><a name="toc-Ref_002eType_002eTup-1" href="#Ref_002eType_002eTup">4.8.8 Ref.Type.Tup</a></li>
      <li><a name="toc-Ref_002eType_002eVec-1" href="#Ref_002eType_002eVec">4.8.9 Ref.Type.Vec</a></li>
      <li><a name="toc-Ref_002eType_002eTag-1" href="#Ref_002eType_002eTag">4.8.10 Ref.Type.Tag</a></li>
      <li><a name="toc-Ref_002eType_002eFn-1" href="#Ref_002eType_002eFn">4.8.11 Ref.Type.Fn</a></li>
      <li><a name="toc-Ref_002eType_002eIter-1" href="#Ref_002eType_002eIter">4.8.12 Ref.Type.Iter</a></li>
      <li><a name="toc-Ref_002eType_002ePort-1" href="#Ref_002eType_002ePort">4.8.13 Ref.Type.Port</a></li>
      <li><a name="toc-Ref_002eType_002eChan-1" href="#Ref_002eType_002eChan">4.8.14 Ref.Type.Chan</a></li>
      <li><a name="toc-Ref_002eType_002eTask-1" href="#Ref_002eType_002eTask">4.8.15 Ref.Type.Task</a></li>
      <li><a name="toc-Ref_002eType_002eObj-1" href="#Ref_002eType_002eObj">4.8.16 Ref.Type.Obj</a></li>
      <li><a name="toc-Ref_002eType_002eConstr-1" href="#Ref_002eType_002eConstr">4.8.17 Ref.Type.Constr</a></li>
      <li><a name="toc-Ref_002eType_002eType-1" href="#Ref_002eType_002eType">4.8.18 Ref.Type.Type</a></li>
    </ul></li>
    <li><a name="toc-Ref_002eExpr-1" href="#Ref_002eExpr">4.9 Ref.Expr</a></li>
    <li><a name="toc-Ref_002eStmt-1" href="#Ref_002eStmt">4.10 Ref.Stmt</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eStmt_002eStat-1" href="#Ref_002eStmt_002eStat">4.10.1 Ref.Stmt.Stat</a>
      <ul class="no-bullet">
        <li><a name="toc-Ref_002eStmt_002eStat_002ePoint-1" href="#Ref_002eStmt_002eStat_002ePoint">4.10.1.1 Ref.Stmt.Stat.Point</a></li>
        <li><a name="toc-Ref_002eStmt_002eStat_002eCFG-1" href="#Ref_002eStmt_002eStat_002eCFG">4.10.1.2 Ref.Stmt.Stat.CFG</a></li>
        <li><a name="toc-Ref_002eStmt_002eStat_002eConstr-1" href="#Ref_002eStmt_002eStat_002eConstr">4.10.1.3 Ref.Stmt.Stat.Constr</a></li>
        <li><a name="toc-Ref_002eStmt_002eStat_002eCond-1" href="#Ref_002eStmt_002eStat_002eCond">4.10.1.4 Ref.Stmt.Stat.Cond</a></li>
        <li><a name="toc-Ref_002eStmt_002eStat_002eTypestate-1" href="#Ref_002eStmt_002eStat_002eTypestate">4.10.1.5 Ref.Stmt.Stat.Typestate</a></li>
        <li><a name="toc-Ref_002eStmt_002eStat_002eCheck-1" href="#Ref_002eStmt_002eStat_002eCheck">4.10.1.6 Ref.Stmt.Stat.Check</a></li>
      </ul></li>
      <li><a name="toc-Ref_002eStmt_002eDecl-1" href="#Ref_002eStmt_002eDecl">4.10.2 Ref.Stmt.Decl</a>
      <ul class="no-bullet">
        <li><a name="toc-Ref_002eStmt_002eDecl_002eItem-1" href="#Ref_002eStmt_002eDecl_002eItem">4.10.2.1 Ref.Stmt.Decl.Item</a></li>
        <li><a name="toc-Ref_002eStmt_002eDecl_002eSlot-1" href="#Ref_002eStmt_002eDecl_002eSlot">4.10.2.2 Ref.Stmt.Decl.Slot</a></li>
      </ul></li>
      <li><a name="toc-Ref_002eStmt_002eCopy-1" href="#Ref_002eStmt_002eCopy">4.10.3 Ref.Stmt.Copy</a></li>
      <li><a name="toc-Ref_002eStmt_002eSpawn-1" href="#Ref_002eStmt_002eSpawn">4.10.4 Ref.Stmt.Spawn</a></li>
      <li><a name="toc-Ref_002eStmt_002eSend-1" href="#Ref_002eStmt_002eSend">4.10.5 Ref.Stmt.Send</a></li>
      <li><a name="toc-Ref_002eStmt_002eFlush-1" href="#Ref_002eStmt_002eFlush">4.10.6 Ref.Stmt.Flush</a></li>
      <li><a name="toc-Ref_002eStmt_002eRecv-1" href="#Ref_002eStmt_002eRecv">4.10.7 Ref.Stmt.Recv</a></li>
      <li><a name="toc-Ref_002eStmt_002eCall-1" href="#Ref_002eStmt_002eCall">4.10.8 Ref.Stmt.Call</a></li>
      <li><a name="toc-Ref_002eStmt_002eBind-1" href="#Ref_002eStmt_002eBind">4.10.9 Ref.Stmt.Bind</a></li>
      <li><a name="toc-Ref_002eStmt_002eRet-1" href="#Ref_002eStmt_002eRet">4.10.10 Ref.Stmt.Ret</a></li>
      <li><a name="toc-Ref_002eStmt_002eBe-1" href="#Ref_002eStmt_002eBe">4.10.11 Ref.Stmt.Be</a></li>
      <li><a name="toc-Ref_002eStmt_002ePut-1" href="#Ref_002eStmt_002ePut">4.10.12 Ref.Stmt.Put</a></li>
      <li><a name="toc-Ref_002eStmt_002eFail-1" href="#Ref_002eStmt_002eFail">4.10.13 Ref.Stmt.Fail</a></li>
      <li><a name="toc-Ref_002eStmt_002eLog-1" href="#Ref_002eStmt_002eLog">4.10.14 Ref.Stmt.Log</a></li>
      <li><a name="toc-Ref_002eStmt_002eNote-1" href="#Ref_002eStmt_002eNote">4.10.15 Ref.Stmt.Note</a></li>
      <li><a name="toc-Ref_002eStmt_002eWhile-1" href="#Ref_002eStmt_002eWhile">4.10.16 Ref.Stmt.While</a></li>
      <li><a name="toc-Ref_002eStmt_002eBreak-1" href="#Ref_002eStmt_002eBreak">4.10.17 Ref.Stmt.Break</a></li>
      <li><a name="toc-Ref_002eStmt_002eCont-1" href="#Ref_002eStmt_002eCont">4.10.18 Ref.Stmt.Cont</a></li>
      <li><a name="toc-Ref_002eStmt_002eFor-1" href="#Ref_002eStmt_002eFor">4.10.19 Ref.Stmt.For</a></li>
      <li><a name="toc-Ref_002eStmt_002eForeach-1" href="#Ref_002eStmt_002eForeach">4.10.20 Ref.Stmt.Foreach</a></li>
      <li><a name="toc-Ref_002eStmt_002eIf-1" href="#Ref_002eStmt_002eIf">4.10.21 Ref.Stmt.If</a></li>
      <li><a name="toc-Ref_002eStmt_002eAlt-1" href="#Ref_002eStmt_002eAlt">4.10.22 Ref.Stmt.Alt</a>
      <ul class="no-bullet">
        <li><a name="toc-Ref_002eStmt_002eAlt_002eComm-1" href="#Ref_002eStmt_002eAlt_002eComm">4.10.22.1 Ref.Stmt.Alt.Comm</a></li>
        <li><a name="toc-Ref_002eStmt_002eAlt_002ePat-1" href="#Ref_002eStmt_002eAlt_002ePat">4.10.22.2 Ref.Stmt.Alt.Pat</a></li>
        <li><a name="toc-Ref_002eStmt_002eAlt_002eType-1" href="#Ref_002eStmt_002eAlt_002eType">4.10.22.3 Ref.Stmt.Alt.Type</a></li>
      </ul></li>
      <li><a name="toc-Ref_002eStmt_002eProve-1" href="#Ref_002eStmt_002eProve">4.10.23 Ref.Stmt.Prove</a></li>
      <li><a name="toc-Ref_002eStmt_002eCheck-1" href="#Ref_002eStmt_002eCheck">4.10.24 Ref.Stmt.Check</a></li>
      <li><a name="toc-Ref_002eStmt_002eIfCheck-1" href="#Ref_002eStmt_002eIfCheck">4.10.25 Ref.Stmt.IfCheck</a></li>
    </ul></li>
    <li><a name="toc-Ref_002eRun-1" href="#Ref_002eRun">4.11 Ref.Run</a>
    <ul class="no-bullet">
      <li><a name="toc-Ref_002eRun_002eMem-1" href="#Ref_002eRun_002eMem">4.11.1 Ref.Run.Mem</a></li>
      <li><a name="toc-Ref_002eRun_002eType-1" href="#Ref_002eRun_002eType">4.11.2 Ref.Run.Type</a></li>
      <li><a name="toc-Ref_002eRun_002eComm-1" href="#Ref_002eRun_002eComm">4.11.3 Ref.Run.Comm</a></li>
      <li><a name="toc-Ref_002eRun_002eRefl-1" href="#Ref_002eRun_002eRefl">4.11.4 Ref.Run.Refl</a></li>
      <li><a name="toc-Ref_002eRun_002eLog-1" href="#Ref_002eRun_002eLog">4.11.5 Ref.Run.Log</a></li>
      <li><a name="toc-Ref_002eRun_002eSig-1" href="#Ref_002eRun_002eSig">4.11.6 Ref.Run.Sig</a></li>
    </ul>
</li>
  </ul></li>
  <li><a name="toc-Index-1" href="#Index">5 Index</a></li>
</ul>
</div>
<hr>
<a name="SEC_About"></a>
<table class="header" cellpadding="1" cellspacing="1" border="0">
<tr><td valign="middle" align="left">[<a href="#Top" title="Cover (top) of document">Top</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_Contents" title="Table of contents">Contents</a>]</td>
<td valign="middle" align="left">[<a href="#Index" title="Index">Index</a>]</td>
<td valign="middle" align="left">[<a href="#SEC_About" title="About (help)"> ? </a>]</td>
</tr></table>
<h1>About This Document</h1>

<p>
  This document was generated on <i>June 13, 2024</i> using <a href="http://www.nongnu.org/texi2html/"><i>texi2html 5.0</i></a>.
</p>
<p>
  The buttons in the navigation panels have the following meaning:
</p>
<table border="1">
  <tr>
    <th> Button </th>
    <th> Name </th>
    <th> Go to </th>
    <th> From 1.2.3 go to</th>
  </tr>
  <tr>
    <td align="center"> [ &lt;&lt; ] </td>
    <td align="center">FastBack</td>
    <td>Beginning of this chapter or previous chapter</td>
    <td>1</td>
  </tr>
  <tr>
    <td align="center"> [ &lt; ] </td>
    <td align="center">Back</td>
    <td>Previous section in reading order</td>
    <td>1.2.2</td>
  </tr>
  <tr>
    <td align="center"> [ Up ] </td>
    <td align="center">Up</td>
    <td>Up section</td>
    <td>1.2</td>
  </tr>
  <tr>
    <td align="center"> [ &gt; ] </td>
    <td align="center">Forward</td>
    <td>Next section in reading order</td>
    <td>1.2.4</td>
  </tr>
  <tr>
    <td align="center"> [ &gt;&gt; ] </td>
    <td align="center">FastForward</td>
    <td>Next chapter</td>
    <td>2</td>
  </tr>
  <tr>
    <td align="center"> [Top] </td>
    <td align="center">Top</td>
    <td>Cover (top) of document</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Contents] </td>
    <td align="center">Contents</td>
    <td>Table of contents</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [Index] </td>
    <td align="center">Index</td>
    <td>Index</td>
    <td> &nbsp; </td>
  </tr>
  <tr>
    <td align="center"> [ ? ] </td>
    <td align="center">About</td>
    <td>About (help)</td>
    <td> &nbsp; </td>
  </tr>
</table>

<p>
  where the <strong> Example </strong> assumes that the current position is at <strong> Subsubsection One-Two-Three </strong> of a document of the following structure:
</p>

<ul>
  <li> 1. Section One
    <ul>
      <li>1.1 Subsection One-One
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.2 Subsection One-Two
        <ul>
          <li>1.2.1 Subsubsection One-Two-One</li>
          <li>1.2.2 Subsubsection One-Two-Two</li>
          <li>1.2.3 Subsubsection One-Two-Three &nbsp; &nbsp;
            <strong>&lt;== Current Position </strong></li>
          <li>1.2.4 Subsubsection One-Two-Four</li>
        </ul>
      </li>
      <li>1.3 Subsection One-Three
        <ul>
          <li>...</li>
        </ul>
      </li>
      <li>1.4 Subsection One-Four</li>
    </ul>
  </li>
</ul>

<hr>
<p>
 <font size="-1">
  This document was generated on <i>June 13, 2024</i> using <a href="http://www.nongnu.org/texi2html/"><i>texi2html 5.0</i></a>.
 </font>
 <br>

</p>
</body>
</html>
